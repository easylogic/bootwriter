/*!
 * Jade - runtime
 * Copyright(c) 2010 TJ Holowaychuk <tj@vision-media.ca>
 * MIT Licensed
 */

define("jadeRuntime",[],function(){var jade=function(exports){function nulls(val){return val!=null}return Array.isArray||(Array.isArray=function(arr){return"[object Array]"==Object.prototype.toString.call(arr)}),Object.keys||(Object.keys=function(obj){var arr=[];for(var key in obj)obj.hasOwnProperty(key)&&arr.push(key);return arr}),exports.merge=function(a,b){var ac=a["class"],bc=b["class"];if(ac||bc)ac=ac||[],bc=bc||[],Array.isArray(ac)||(ac=[ac]),Array.isArray(bc)||(bc=[bc]),ac=ac.filter(nulls),bc=bc.filter(nulls),a["class"]=ac.concat(bc).join(" ");for(var key in b)key!="class"&&(a[key]=b[key]);return a},exports.attrs=function(obj,escaped){var buf=[],terse=obj.terse;delete obj.terse;var keys=Object.keys(obj),len=keys.length;if(len){buf.push("");for(var i=0;i<len;++i){var key=keys[i],val=obj[key];"boolean"==typeof val||null==val?val&&(terse?buf.push(key):buf.push(key+'="'+key+'"')):0==key.indexOf("data")&&"string"!=typeof val?buf.push(key+"='"+JSON.stringify(val)+"'"):"class"==key&&Array.isArray(val)?buf.push(key+'="'+exports.escape(val.join(" "))+'"'):escaped&&escaped[key]?buf.push(key+'="'+exports.escape(val)+'"'):buf.push(key+'="'+val+'"')}}return buf.join(" ")},exports.escape=function(html){return String(html).replace(/&(?!(\w+|\#\d+);)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},exports.rethrow=function(err,filename,lineno){if(!filename)throw err;var context=3,str=require("fs").readFileSync(filename,"utf8"),lines=str.split("\n"),start=Math.max(lineno-context,0),end=Math.min(lines.length,lineno+context),context=lines.slice(start,end).map(function(line,i){var curr=i+start+1;return(curr==lineno?"  > ":"    ")+curr+"| "+line}).join("\n");throw err.path=filename,err.message=(filename||"Jade")+":"+lineno+"\n"+context+"\n\n"+err.message,err},exports}({});return jade}),define("logic/tpl/LogicMain.js",["jadeRuntime"],function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;buf.push('<div class="span12 logic-view"><div class="titlebar"></div><div class="contents"></div></div>')}return buf.join("")}}),define("logic/tpl/LogicToolbar.js",["jadeRuntime"],function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;buf.push('<div class="btn-group"><a data-toggle="dropdown" class="btn dropdown-toggle">Tool\n&nbsp;<span class="caret"></span></a><ul class="dropdown-menu"><li><a href="#copy" class="copy">Copy</a></li><li><a href="#export_html" class="export_html">Export HTML</a></li><li><a href="#export_json" class="export_json">Export JSON</a></li></ul></div>')}return buf.join("")}}),define("logic/LogicToolbar.js",["./tpl/LogicToolbar.js"],function(tpl){return Backbone.View.extend({className:"logic-toolbar btn-toolbar",events:{"click .copy":"copy","click .export_html":"exportHTML","click .export_json":"exportJSON"},exportHTML:function(e){},exportJSON:function(e){},htmlEntities:function(str){return String(str).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},setTextIndent:function($dom){var inden="	"},getHtmlText:function(){var obj=$(".logic-contents").clone();obj.find(".logic-comp-menu,.logic-comp-iconpoint,.logic-comp-childpoint:empty,logic-comp-viewpoint:empty").remove(),obj.find("[data-cid]").removeAttr("data-cid");var temp=$("<div />");temp.append(obj);var text=style_html(temp.html(),{indent_size:2,indent_char:" ",max_char:78,brace_style:"expand",unformatted:["a","sub","sup","b","i","u"]});return text},copy:function(e){var prev=$("<pre />"),popup=$('<div class="alert" />');popup.append('<a class="close" data-dismiss="alert" href="#">&times;</a>'),prev.text(this.getHtmlText()).appendTo(popup),popup.appendTo("body").css({top:100,left:"30%",position:"absolute",width:700,overflow:"auto"}).show()},render:function(){return this.$el.append(tpl()),this}})}),define("logic/tpl/LogicMenuBox.js",["jadeRuntime"],function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;buf.push('<a href="#" class="btn plus-btn"><i class="icon-plus"></i></a>')}return buf.join("")}}),define("logic/tpl/LogicToys.js",["jadeRuntime"],function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;buf.push('<div class="modal hide"><div class="modal-header"><h2 class="modal-header-title">Add Toys</h2><ul class="nav nav-pills modal-header-menu pull-right">'),function(){if("number"==typeof App.menubox.length)for(var key=0,$$l=App.menubox.length;key<$$l;key++){var obj=App.menubox[key];buf.push("<li"),buf.push(attrs({"class":key=="basecss"?"active":""},{"class":!0})),buf.push("><a"),buf.push(attrs({href:"#"+key,"data-toggle":"tab"},{href:!0,"data-toggle":!0})),buf.push(">");var __val__=obj.name;buf.push(null==__val__?"":__val__),buf.push("</a></li>")}else for(var key in App.menubox){var obj=App.menubox[key];buf.push("<li"),buf.push(attrs({"class":key=="basecss"?"active":""},{"class":!0})),buf.push("><a"),buf.push(attrs({href:"#"+key,"data-toggle":"tab"},{href:!0,"data-toggle":!0})),buf.push(">");var __val__=obj.name;buf.push(null==__val__?"":__val__),buf.push("</a></li>")}}.call(this),buf.push('</ul></div><div class="modal-body"><div class="tab-content">'),function(){if("number"==typeof App.menubox.length)for(var key=0,$$l=App.menubox.length;key<$$l;key++){var obj=App.menubox[key];buf.push("<div"),buf.push(attrs({id:key,"class":"tab-pane "+(key=="basecss"?"active":"")},{"class":!0,id:!0})),buf.push('><ul style="margin-left:0px;" class="thumbnails">'),function(){if("number"==typeof obj.list.length)for(var $index=0,$$l=obj.list.length;$index<$$l;$index++){var name=obj.list[$index],toy=App.list[name];buf.push("<li"),buf.push(attrs({style:"text-align:center;width:108px;margin-bottom:16px;cursor:pointer;","data-name":"toy","data-type":toy.type,"class":"span2"},{style:!0,"data-name":!0,"data-type":!0})),buf.push("><div"),buf.push(attrs({style:"padding: 20px 0px;","class":App.list[name].view},{"class":!0,style:!0})),buf.push('> <a href="#" style="cursor:pointer;color:black"><i'),buf.push(attrs({style:"margin-bottom:5px;","class":toy.icon},{"class":!0,style:!0})),buf.push("></i><br/>");var __val__=toy.name;buf.push(null==__val__?"":__val__),buf.push("</a></div></li>")}else for(var $index in obj.list){var name=obj.list[$index],toy=App.list[name];buf.push("<li"),buf.push(attrs({style:"text-align:center;width:108px;margin-bottom:16px;cursor:pointer;","data-name":"toy","data-type":toy.type,"class":"span2"},{style:!0,"data-name":!0,"data-type":!0})),buf.push("><div"),buf.push(attrs({style:"padding: 20px 0px;","class":App.list[name].view},{"class":!0,style:!0})),buf.push('> <a href="#" style="cursor:pointer;color:black"><i'),buf.push(attrs({style:"margin-bottom:5px;","class":toy.icon},{"class":!0,style:!0})),buf.push("></i><br/>");var __val__=toy.name;buf.push(null==__val__?"":__val__),buf.push("</a></div></li>")}}.call(this),buf.push("</ul></div>")}else for(var key in App.menubox){var obj=App.menubox[key];buf.push("<div"),buf.push(attrs({id:key,"class":"tab-pane "+(key=="basecss"?"active":"")},{"class":!0,id:!0})),buf.push('><ul style="margin-left:0px;" class="thumbnails">'),function(){if("number"==typeof obj.list.length)for(var $index=0,$$l=obj.list.length;$index<$$l;$index++){var name=obj.list[$index],toy=App.list[name];buf.push("<li"),buf.push(attrs({style:"text-align:center;width:108px;margin-bottom:16px;cursor:pointer;","data-name":"toy","data-type":toy.type,"class":"span2"},{style:!0,"data-name":!0,"data-type":!0})),buf.push("><div"),buf.push(attrs({style:"padding: 20px 0px;","class":App.list[name].view},{"class":!0,style:!0})),buf.push('> <a href="#" style="cursor:pointer;color:black"><i'),buf.push(attrs({style:"margin-bottom:5px;","class":toy.icon},{"class":!0,style:!0})),buf.push("></i><br/>");var __val__=toy.name;buf.push(null==__val__?"":__val__),buf.push("</a></div></li>")}else for(var $index in obj.list){var name=obj.list[$index],toy=App.list[name];buf.push("<li"),buf.push(attrs({style:"text-align:center;width:108px;margin-bottom:16px;cursor:pointer;","data-name":"toy","data-type":toy.type,"class":"span2"},{style:!0,"data-name":!0,"data-type":!0})),buf.push("><div"),buf.push(attrs({style:"padding: 20px 0px;","class":App.list[name].view},{"class":!0,style:!0})),buf.push('> <a href="#" style="cursor:pointer;color:black"><i'),buf.push(attrs({style:"margin-bottom:5px;","class":toy.icon},{"class":!0,style:!0})),buf.push("></i><br/>");var __val__=toy.name;buf.push(null==__val__?"":__val__),buf.push("</a></div></li>")}}.call(this),buf.push("</ul></div>")}}.call(this),buf.push("</div></div></div>")}return buf.join("")}}),define("logic/LogicMenuBox.js",["./tpl/LogicMenuBox.js","./tpl/LogicToys.js"],function(tpl,tplToys){return Backbone.View.extend({show:function(){this.$el.show()},hide:function(){this.$el.hide()},render:function(){var self=this;return this.$el.append(tpl({toyList:this.toyList})),this.$(".plus-btn").click(function(e){var temp=$(tplToys());return $("body").append(temp),temp.bPopup({}),temp.find("[data-name=toy]").draggable({helper:"clone",revert:!0,connectToSortable:".logic-comp-childpoint",containment:".logic-comp-childpoint",start:function(e,ui){temp.close()}}).click(function(e){return App.toy!=null?App.toy.addObjectAt($(this).data("type"),App.toy.model.get("span"),"right"):App.main.contents.rootBox.addObject($(this).data("type"),12),temp.close(),!1}),!1}),this}})}),define("logic/toy/tpl/object.js",["jadeRuntime"],function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;if(typeof skinText!="undefined"&&skinText){buf.push('<style type="text/css">');var __val__=skinText;buf.push(null==__val__?"":__val__),buf.push("</style>")}buf.push("<div"),buf.push(attrs({id:cid},{id:!0})),buf.push(">");if(!isContainer){buf.push("<div"),buf.push(attrs({"data-cid":cid,id:cid,"class":"logic-comp-viewpoint"},{"data-cid":!0,id:!0})),buf.push('><div class="viewText">');var __val__=viewText;buf.push(null==__val__?"":__val__),buf.push("</div></div>")}isContainer&&(buf.push("<div"),buf.push(attrs({"data-cid":cid,"class":"logic-comp-childpoint "+(rowType=="fluid"?"row-fluid":"row")},{"class":!0,"data-cid":!0})),buf.push("></div>")),buf.push("</div>")}return buf.join("")}}),define("logic/toy/ToyModel.js",[],function(){return Backbone.Model.extend({urlRoot:"/toys",idAttribute:"_id",defaults:{isRoot:!1,title:"",span:12,hspan:"",offset:"",text:"",viewText:"",auth:{},tag:[],skin:"",children:[]}})}),define("logic/toy/ToyObject.js",["./tpl/object.js","./ToyModel.js"],function(tpl,Model){return Backbone.View.extend({events:{"dblclick .viewText":"selectEdit","doubletab .viewText":"selectEdit"},appendBeforeObject:function(comp){!this.isRoot()&&this.parent.isContainer&&this.parent.beforeComp(this,comp)},appendAfterObject:function(comp){!this.isRoot()&&this.parent.isContainer&&this.parent.afterComp(this,comp)},getModel:function(){var model=new Model({type:this.type});return model.view=this,model},isRoot:function(){return!1},initialize:function(opt){App.toys[this.cid]=this,this.preload(),this.base(opt)},preload:function(){},base:function(opt){opt=opt||{};var self=this;this.model=this.getModel(),this.model.view=this,this.settings=this.getSettings(),this.$el.hide(),opt.isRoot&&this.model.set("isRoot",opt.isRoot),opt.parent&&(this.parent=opt.parent),opt._id?this.load(opt._id,function(){opt.success&&opt.success.call(self)}):(!this.isRoot()&&opt.span&&this.model.set("span",opt.span),this.save({success:function(){opt.success&&opt.success.call(self)}}))},load:function(_id,callback){var self=this;this.model.id=_id,this.model.fetch({success:function(){self.render(),callback()}})},toJSON:function(){return this.model.toJSON()},setModel:function(obj,callback){this.model.set(obj),this.save(null,callback)},save:function(opt,callback){this.model.save(opt,{success:function(){callback&&callback()},error:function(model,res){alert(res.responseText)}})},saveChildren:function(){},remove:function(){this.parent&&(this.parent.removeComp(this.cid),this.parent.initBackground())},removeAll:function(){confirm("Are you really delete toy?")&&(this.remove(),this.$el.remove())},resetHSpan:function(hspan){hspan=hspan==undefined?this.model.get("hspan"):hspan;if($("#cal_height").length)var obj=$("#cal_height").removeClass(function(index,css){var matches=css.match(/span\d+/g)||[];return matches.join(" ")}).addClass("span"+hspan);else{var obj=$('<div id="cal_height" />').addClass("span"+hspan);obj.hide().appendTo("body")}var width=obj.width();this.$el.parent().css("height",""),hspan>0&&this.$el.parent().height(width+"px").attr("data-cid",this.cid)},changeSpan:function(span){var temp=parseInt(this.model.get("span"))+(parseInt(span)||1);if(temp<1||temp>12)return!1;this.model.set("span",temp),this.resetSpan(),this.save()},changeOffset:function(offset){var prevOffset=this.model.get("offset");prevOffset||(prevOffset=0);var temp=parseInt(prevOffset)+(parseInt(offset)||1);if(temp<0||temp>11)return!1;this.model.set("offset",temp),this.resetOffset(),this.save()},resetSpan:function(span){span=span==undefined?this.model.get("span"):span,this.$el.parent().removeClass(function(index,css){var matches=css.match(/span\d+/g)||[];return matches.join(" ")}),span>0&&this.$el.parent().addClass("span"+span,"slow").attr("data-cid",this.cid)},resetOffset:function(offset){offset=offset==undefined?this.model.get("offset"):offset,this.$el.parent().removeClass(function(index,css){var matches=css.match(/offset\d+/g)||[];return matches.join(" ")}),offset>0&&this.$el.parent().addClass("offset"+offset).attr("data-cid",this.cid)},show:function(isSettings){this.$el.fadeIn("fast"),isSettings&&this.settings.open()},hide:function(){this.$el.fadeOut("fast")},getMaxSpan:function(){return 12},getSpanList:function(max){var span_list=[];for(var i=1;i<=max;i++)span_list.push(i);return span_list},appendLeft:function(comp,isCreate){this.parent&&this.parent.isContainer&&this.parent.beforeComp(this,comp,isCreate)},appendRight:function(comp,isCreate){this.parent&&this.parent.isContainer&&this.parent.afterComp(this,comp,isCreate)},getPoint:function(type){return this.$(".logic-comp-"+type+"[data-cid="+this.cid+"]")},getViewPoint:function(){return this.getPoint("viewpoint")},getChildPoint:function(){return this.getPoint("childpoint")},getIconPoint:function(){return this.getPoint("iconpoint")},getTplData:function(){var data=_.extend(this.getDefaultValue(),this.toJSON(),{cid:this.cid,isRoot:this.isRoot(),isContainer:this.isContainer});return data.viewText||(data.viewText="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"),data.skinText&&(data.skinText=data.skinText.replace(/.skinText/,"#"+this.cid)),data},setStyle:function(data){var obj=this.getViewPoint();this.resetSpan(data.span),this.resetOffset(data.offset),this.resetHSpan(data.hspan),App.mode!="write"},addObjectAt:function(type,span,align){var Comp=null,self=this;span=span||12,align=align||"left",App.require(type,function(Comp){var value=_.extend({span:span,parent:self.parent}),obj={};obj=new Comp(value),obj.render(),align=="left"?self.appendLeft(obj,!0):align=="right"&&self.appendRight(obj,!0),obj.show(!0),setTimeout(function(){self.parent.save()},1e3)})},setSelectedToy:function(){App.setSelectToy(this),$(".select_box").removeClass("select_box"),this.$el.addClass("select_box"),this.scroll()},initContextMenu:function(){this.$el.popover("destroy")},scroll:function(){$("html,body").animate({scrollTop:this.$el.offset().top-150},"fast")},setDragEvent:function(){if(App.mode=="view")return;var self=this;if(!this.isRoot()){this.$el.click(function(e){return e.stopPropagation(),App.initContextMenu(),self.setSelectedToy(),!1});var grid=App.GridWidth+App.GridGutter,resizableReset=function(e,ui){var handle=$(this).css("cursor").split("-")[0];if(handle=="w"){var offset=Math.floor((Math.abs(ui.position.left)+App.GridGutter)/(App.GridGutter+App.GridWidth));ui.position.left>0?offset=App.offsetOrigin+offset:offset=App.offsetOrigin-offset,offset<0&&(offset=0);var span=App.spanOrigin-offset;self.$el.css({top:"",left:"",width:"",height:""}),e.ctrlKey?(self.resetOffset(offset),self.resetSpan(span)):self.resetOffset(offset),App.offset=offset,App.span=span,App.resizableMode="w"}else{var span=Math.floor((ui.size.width+App.GridGutter)/(App.GridGutter+App.GridWidth));span>12&&(span=12),self.$el.css({top:"",left:"",width:"",height:""}),self.model.set({span:span}),self.resetSpan(),App.resizableMode="e"}};this.$el.resizable("destroy").resizable({minHeight:App.GridWidth,minWidth:App.GridWidth,containment:".logic-comp-childpoint",handles:"e,w",distance:App.GridGutter,grid:grid,start:function(e,ui){var handle=$(this).css("cursor").split("-")[0];handle=="w"&&(App.spanOrigin=parseInt(self.model.get("offset")||0)+parseInt(self.model.get("span")||0),App.offsetOrigin=parseInt(self.model.get("offset")||0))},resize:function(e,ui){resizableReset.call(this,e,ui)},stop:function(e,ui){App.resizableMode=="w"&&(e.ctrlKey?(self.model.set("offset",App.offset),self.model.set("span",App.span)):self.model.set("offset",App.offset)),App.resizableMode="",App.offset="",App.span="",self.save()}})}this.getChildPoint().sortable({connectWith:".logic-comp-childpoint",helper:"clone",placeholder:"sortableHelper",tolerance:"intersect",start:function(event,ui){$(".sortableHelper").addClass(ui.item.attr("class")).html(ui.item.clone().html()).css({height:ui.item.height(),opacity:.5}).find("> div").removeClass("select_box"),$(".sortableHelper").find(".ui-resizable-handle").remove(),$(".sortableHelper").removeClass(".ui-resizable")},beforeStop:function(event,ui){ui.item.fadeOut(50).fadeIn("slow")},stop:function(event,ui){if(ui.item.data("name")){$(".modal").remove(),$(".modal-backdrop").remove();var box=App.toys[ui.item.parent().data("cid")],prev=ui.item.prev();if(prev){var toy=App.toys[prev.data("cid")];toy.addObjectAt(ui.item.data("type"),box.model.get("span")||App.MaxSpan,"right")}else box.addObject(ui.item.data("type"),box.model.get("span")||App.MaxSpan,"first");ui.item.hide("slow").remove()}else{$(this).css("background","");var toy=App.toys[ui.item.data("cid")],box=App.toys[toy.$el.parent().parent().data("cid")];box.cid!=toy.parent.cid&&(toy.remove(),toy.parent=box),box.sortChildren()}}})},selectEdit:function(){return App.mode!="view"&&this.settings.open(),!1},update:function(){this.render()},getTpl:function(data){return""},getSettings:function(){return{}},renderViewPoint:function(data){this.getPoint("viewpoint").html(this.getTpl(data))},renderChildPoint:function(data){},getDefaultValue:function(){return{}},onRender:function(data){},isContainer:!1,isCustomRender:!1,firstChild:function(){return this.getChildPoint().children().first()},lastChild:function(){return this.getChildPoint().children().last()},next:function(){return this.$el.parent().next()},prev:function(){return this.$el.parent().prev()},moveNext:function(){var obj=this.next();obj.length&&(App.toys[obj.data("cid")].appendRight(this),this.scroll())},movePrev:function(){var obj=this.prev();obj.length&&(App.toys[obj.data("cid")].appendLeft(this),this.scroll())},render:function(){var data=this.getTplData();return this.$el.html(tpl(data)),this.$el.attr("data-cid",this.cid),this.delegateEvents(),this.setStyle(data),this.setDragEvent(),this.onRender(data),this.renderChildPoint(data),this},exportHTML:function(){},exportJSON:function(){var data=this.model.toJSON(),temp=[];if(this.children)for(var i in this.children){var child=this.children[i];if(typeof child=="function")continue;temp.push(child.model.toJSON())}return data.children=temp,data}})}),define("logic/toy/ToyContainer.js",["./ToyObject.js"],function(ToyObject){return ToyObject.extend({isContainer:!0,beforeComp:function(src,target,isCreate){this.beforeRender(src,target,isCreate),this.beforeToy(src,target),this.initBackground()},afterComp:function(src,target,isCreate){this.afterRender(src,target,isCreate),this.afterToy(src,target),this.initBackground()},insertComp:function(target){this.insertRender(target),this.insertToy(target),this.initBackground()},removeComp:function(cid){var temp=[];for(var i in this.children){var child=this.children[i];if(typeof child=="function")continue;if(child.cid==cid)continue;temp.push(child)}this.children=temp,this.saveChildren(),this.initBackground()},firstComp:function(obj){this.firstToy(obj),this.firstRender(obj),this.initBackground()},lastComp:function(obj){this.lastToy(obj),this.lastRender(obj),this.initBackground()},insertObject:function(comp){this.insertComp(comp),this.initBackground()},beforeRender:function(src,target,isCreate){target.hide();if(isCreate){var wrap=this.wrap("");src.$el.parent().before(wrap.html(target.$el)),target.resetSpan()}else src.$el.parent().before(target.$el.parent());target.show()},afterRender:function(src,target,isCreate){target.hide();if(isCreate){var wrap=this.wrap("");src.$el.parent().after(wrap.html(target.$el)),target.resetSpan()}else src.$el.parent().after(target.$el.parent());target.show()},insertRender:function(target){target.hide();var wrap=this.wrap("");this.getChildPoint().append(wrap.html(target.$el)),target.resetSpan(),target.show()},firstRender:function(obj){this.prependElement(this.wrap(obj.$el)),obj.resetSpan()},lastRender:function(obj){this.appendElement(this.wrap(obj.$el)),obj.resetSpan()},appendElement:function(elem){this.getChildPoint().append(elem)},prependElement:function(elem){this.getChildPoint().prepend(elem)},beforeToy:function(src,target){target.remove();var temp=[];for(var i in this.children){var child=this.children[i];child.cid==src.cid&&temp.push(target),temp.push(child)}this.children=temp,this.saveChildren()},afterToy:function(src,target){target.remove();var temp=[];for(var i in this.children){var child=this.children[i];temp.push(child),child.cid==src.cid&&temp.push(target)}this.children=temp,this.saveChildren()},insertToy:function(target){target.remove(),this.children.push(target),target.parent=this,this.saveChildren()},sortChildren:function(){var temp=[];this.getChildPoint().find("> [data-cid]").each(function(i,obj){temp[i]=App.toys[$(obj).data("cid")]}),this.children=temp,this.saveChildren(),this.initBackground()},firstToy:function(obj){this.children.unshift(obj)},setToy:function(i,obj){this.children[i]=obj},lastToy:function(obj){this.children.push(obj)},addWrap:function(html){html=html||"";var wrap_html=this.initWrap(html);return this.appendElement(wrap_html),wrap_html},initWrap:function(html){return $("<div />").html(html)},addObjectById:function(obj,isLoad,i){var self=this,opt=obj,isLoad=isLoad||!1,i=i||0,wrap_html=this.addWrap(),index=i;App.require(obj.type,function(Comp){var toy=new Comp({parent:self,_id:obj.id});wrap_html.html(toy.$el),self.children[index]=toy,toy.show(!1),self.initBackground()})},renderChildPoint:function(data){for(var i in this.children){var child=this.children[i];if(typeof child=="function")continue;var wrap_html=this.addWrap();wrap_html.html(child.$el),child.render()}this.initBackground()},initBackground:function(){if(App.mode=="view")return;this.children.length==0?this.isRoot()||this.getChildPoint().html("<div class='blank' style='margin-left:20px;'><div class='blank-inner'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div></div>").find(".blank-inner").css({border:"1px dashed black"}):this.isRoot()||this.getChildPoint().find(".blank").remove()},addObject:function(type,span,align){var Comp=null,self=this;align=align||"last",App.require(type,function(Comp){var value=_.extend({span:span,parent:self}),obj={};obj=new Comp(value),obj.render(),align=="first"?self.firstComp(obj):align=="last"&&self.lastComp(obj),obj.show(!0),setTimeout(function(){self.save()},1e3)})},load:function(_id){var self=this;this.model.id=_id,this.model.fetch({success:function(){self.render(),self.loadToys()}})},loadToys:function(){this.children=this.model.get("children");for(var i in this.children){var child=this.children[i];if(typeof child=="function")continue;this.addObjectById(child,!0,i)}},getToys:function(){var temp=[];if(this.children)for(var i in this.children){var child=this.children[i];if(typeof child=="function")continue;temp.push({type:child.type,id:child.model.id})}return temp},save:function(opt,callback){var self=this,obj={};this.isContainer&&(obj={children:this.getToys()}),this.model.save(obj,{success:function(){callback&&callback(),self.isRoot()&&App.main.setTitle(self.model.get("title"))},error:function(model,res){alert(res.responseText)}})},saveChildren:function(){var obj={children:[]};this.isContainer&&(obj.children=this.getToys()),$.ajax({url:"/toys/children/"+this.model.id,type:"POST",data:obj,dataType:"json",success:function(data){}})},wrap:function(elem){return $("<div />").html(elem)},preload:function(opt){this.children=[]}})}),define("logic/toy/tpl/settings.js",["jadeRuntime"],function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp,input_text_mixin=function(value,name,title){var block=this.block,attributes=this.attributes||{},escaped=this.escaped||{};buf.push("<input"),buf.push(attrs({type:"text",value:value,placeholder:"Insert "+title,"class":"span8 "+name},{"class":!0,type:!0,value:!0,placeholder:!0})),buf.push("/>")},title_mixin=function(value,name){var block=this.block,attributes=this.attributes||{},escaped=this.escaped||{};buf.push("<input"),buf.push(attrs({type:"text",value:value,placeholder:"Insert "+(name?name:"Title"),"class":"span8 title"},{type:!0,value:!0,placeholder:!0})),buf.push("/>")},text_mixin=function(value,name,rows){var block=this.block,attributes=this.attributes||{},escaped=this.escaped||{};rows=rows?rows:10,buf.push("<textarea"),buf.push(attrs({rows:rows,placeholder:"Insert "+(name?name:"Content"),"class":"span8 text"},{rows:!0,placeholder:!0})),buf.push(">");var __val__=value;buf.push(null==__val__?"":__val__),buf.push("</textarea>")},select_mixin=function(name,list,value,title){var block=this.block,attributes=this.attributes||{},escaped=this.escaped||{};buf.push("<select"),buf.push(attrs({"data-placeholder":title,style:"margin-bottom:10px;","class":name},{"class":!0,"data-placeholder":!0,style:!0})),buf.push('><option value=""></option>'),function(){if("number"==typeof list.length)for(var $index=0,$$l=list.length;$index<$$l;$index++){var list_value=list[$index];if(list_value==value){buf.push("<option"),buf.push(attrs({value:list_value,selected:"selected"},{value:!0,selected:!0})),buf.push(">");var __val__=list_value;buf.push(escape(null==__val__?"":__val__)),buf.push("</option>")}else{buf.push("<option"),buf.push(attrs({value:list_value},{value:!0})),buf.push(">");var __val__=list_value;buf.push(escape(null==__val__?"":__val__)),buf.push("</option>")}}else for(var $index in list){var list_value=list[$index];if(list_value==value){buf.push("<option"),buf.push(attrs({value:list_value,selected:"selected"},{value:!0,selected:!0})),buf.push(">");var __val__=list_value;buf.push(escape(null==__val__?"":__val__)),buf.push("</option>")}else{buf.push("<option"),buf.push(attrs({value:list_value},{value:!0})),buf.push(">");var __val__=list_value;buf.push(escape(null==__val__?"":__val__)),buf.push("</option>")}}}.call(this),buf.push("</select>")},tag_mixin=function(value){var block=this.block,attributes=this.attributes||{},escaped=this.escaped||{};buf.push("<input"),buf.push(attrs({type:"text",value:value.join(","),placeholder:"Insert Tag","class":"span8 tag"},{type:!0,value:!0,placeholder:!0})),buf.push("/>")},checkbox_mixin=function(name,value,title){var block=this.block,attributes=this.attributes||{},escaped=this.escaped||{};buf.push('<label class="checkbox">'),value?(buf.push("<input"),buf.push(attrs({type:"checkbox",checked:"checked",style:"display:inline-block","class":name},{"class":!0,type:!0,checked:!0,style:!0})),buf.push("/>")):(buf.push("<input"),buf.push(attrs({type:"checkbox",style:"display:inline-block","class":name},{"class":!0,type:!0,style:!0})),buf.push("/>"));var __val__=title;buf.push(null==__val__?"":__val__),buf.push("</label>")};buf.push('<div class="modal-header"><h3 class="modal-header-title">');var __val__=App.list[type].name;buf.push(null==__val__?"":__val__),buf.push('</h3><ul class="nav nav-pills modal-header-menu pull-right">');var i=1;buf.push('<li class="active"><a'),buf.push(attrs({href:"#data","data-toggle":"tab",rel:"tooltip",title:"Alt + "+i++},{href:!0,"data-toggle":!0,rel:!0,title:!0})),buf.push(">Data</a></li>"),isThemes&&(buf.push("<li><a"),buf.push(attrs({href:"#themes","data-toggle":"tab",rel:"tooltip",title:"Alt + "+i++},{href:!0,"data-toggle":!0,rel:!0,title:!0})),buf.push(">Themes</a></li>")),buf.push("<li><a"),buf.push(attrs({href:"#skin","data-toggle":"tab",rel:"tooltip",title:"Alt + "+i++},{href:!0,"data-toggle":!0,rel:!0,title:!0})),buf.push(">Skin</a></li>");if(isList){buf.push("<li><a"),buf.push(attrs({href:"#list","data-toggle":"tab",rel:"tooltip",title:"Alt + "+i++},{href:!0,"data-toggle":!0,rel:!0,title:!0})),buf.push('> \nList &nbsp;<span class="badge badge-info">');var __val__=list.length;buf.push(null==__val__?"":__val__),buf.push("</span></a></li>")}isUpload&&(buf.push("<li><a"),buf.push(attrs({href:"#upload","data-toggle":"tab",rel:"tooltip",title:"Alt + "+i++},{href:!0,"data-toggle":!0,rel:!0,title:!0})),buf.push("> \nUpload &nbsp;</a></li>")),buf.push('</ul><form style="display:inline;margin-left:10px;margin-right:10px;margin-top:4px;" class="form-inline"><select data-placeholder="Span" style="width:70px;" class="span1 spanarea"><option value=""></option>'),function(){if("number"==typeof span_list.length)for(var $index=0,$$l=span_list.length;$index<$$l;$index++){var list_value=span_list[$index];if(list_value==span){buf.push("<option"),buf.push(attrs({value:list_value,selected:"selected"},{value:!0,selected:!0})),buf.push(">");var __val__=list_value;buf.push(escape(null==__val__?"":__val__)),buf.push("</option>")}else{buf.push("<option"),buf.push(attrs({value:list_value},{value:!0})),buf.push(">");var __val__=list_value;buf.push(escape(null==__val__?"":__val__)),buf.push("</option>")}}else for(var $index in span_list){var list_value=span_list[$index];if(list_value==span){buf.push("<option"),buf.push(attrs({value:list_value,selected:"selected"},{value:!0,selected:!0})),buf.push(">");var __val__=list_value;buf.push(escape(null==__val__?"":__val__)),buf.push("</option>")}else{buf.push("<option"),buf.push(attrs({value:list_value},{value:!0})),buf.push(">");var __val__=list_value;buf.push(escape(null==__val__?"":__val__)),buf.push("</option>")}}}.call(this),buf.push('</select>&nbsp;              <select data-placeholder="Offset" style="width:70px;" class="span1 offsetarea"><option value=""></option>'),function(){if("number"==typeof span_list.length)for(var $index=0,$$l=span_list.length;$index<$$l;$index++){var list_value=span_list[$index];if(list_value==offset){buf.push("<option"),buf.push(attrs({value:list_value,selected:"selected"},{value:!0,selected:!0})),buf.push(">");var __val__=list_value;buf.push(escape(null==__val__?"":__val__)),buf.push("</option>")}else{buf.push("<option"),buf.push(attrs({value:list_value},{value:!0})),buf.push(">");var __val__=list_value;buf.push(escape(null==__val__?"":__val__)),buf.push("</option>")}}else for(var $index in span_list){var list_value=span_list[$index];if(list_value==offset){buf.push("<option"),buf.push(attrs({value:list_value,selected:"selected"},{value:!0,selected:!0})),buf.push(">");var __val__=list_value;buf.push(escape(null==__val__?"":__val__)),buf.push("</option>")}else{buf.push("<option"),buf.push(attrs({value:list_value},{value:!0})),buf.push(">");var __val__=list_value;buf.push(escape(null==__val__?"":__val__)),buf.push("</option>")}}}.call(this),buf.push('</select>&nbsp;            <select data-placeholder="Height" style="width:70px;" class="span1 hspanarea"><option value=""></option>'),function(){if("number"==typeof span_list.length)for(var $index=0,$$l=span_list.length;$index<$$l;$index++){var list_value=span_list[$index];if(list_value==hspan){buf.push("<option"),buf.push(attrs({value:list_value,selected:"selected"},{value:!0,selected:!0})),buf.push(">");var __val__=list_value;buf.push(escape(null==__val__?"":__val__)),buf.push("</option>")}else{buf.push("<option"),buf.push(attrs({value:list_value},{value:!0})),buf.push(">");var __val__=list_value;buf.push(escape(null==__val__?"":__val__)),buf.push("</option>")}}else for(var $index in span_list){var list_value=span_list[$index];if(list_value==hspan){buf.push("<option"),buf.push(attrs({value:list_value,selected:"selected"},{value:!0,selected:!0})),buf.push(">");var __val__=list_value;buf.push(escape(null==__val__?"":__val__)),buf.push("</option>")}else{buf.push("<option"),buf.push(attrs({value:list_value},{value:!0})),buf.push(">");var __val__=list_value;buf.push(escape(null==__val__?"":__val__)),buf.push("</option>")}}}.call(this),buf.push('</select></form></div><div class="modal-body"><div class="tab-content">'),isList&&(isTable?buf.push('<div id="list" class="tab-pane fade"><a style="width:70px" class="btn btn-success add_row">row+</a>&nbsp;<a style="width:70px" class="btn btn-info add_column">col+    </a><table><tr class="column"><td class="ui-state-disabled"><a style="width:70px;background:white;margin:0px;" class="btn init_row ui-state-disabled">&nbsp;</a></td></tr></table><table><tbody class="list"></tbody></table></div>'):(buf.push('<div id="list" class="tab-pane fade"><span style="overflow:auto;height:350px;" class="span4 data_list"></span><span style="display:inline;width:550px;" class="span4"><ul class="nav nav-tabs"><li class="active"><a href="#settings_list_base" data-toggle="tab">Base</a></li><li><a href="#settings_list_ext" data-toggle="tab">Extend    </a></li><li><a href="#settings_list_form" data-toggle="tab">Form</a></li><li><a class="btn btn-success add_data"> \nAdd &nbsp;<i class="icon-plus icon-white">     </i></a></li><li><a class="btn btn-info modify_data">Modify &nbsp;<i class="icon-edit icon-white"></i></a></li></ul><div class="tab-content"><div id="settings_list_ext" style="height:400px;" class="tab-pane"><form><fieldset><div class="input-append"><select data-name="buttonSize" data-placeholder="Button Size" style="width:300px;" class="data"><option value=""></option><option value="large">large</option><option value="small">small</option><option value="mini">mini</option></select></div><div class="input-append"><select data-name="buttonType" data-placeholder="Button Type" style="width:300px;" class="data"><option value=""></option><option value="primary">primary</option><option value="danger">danger</option><option value="warning">warning              </option><option value="success">success              </option><option value="info">info              </option><option value="inverse">inverse</option></select></div><div class="input-append"><select data-name="activeType" data-placeholder="Active Type" style="width:300px;" class="data"><option value=""></option><option value="active">active</option><option value="nav-header">nav-header</option><option value="divider">divider          </option><option value="disabled">disabled          </option><option value="previous">previous          </option><option value="next">next          </option></select></div><div class="input-append"><select data-name="groupType" data-placeholder="Group Type" style="width:300px;" class="data"><option value=""></option><option value="vertical">vertical</option></select></div><div class="input-append"><select data-name="buttonBlock" data-placeholder="Button Block" style="width:300px;" class="data"><option value=""></option><option value="block">block              </option></select></div></fieldset></form></div><div id="settings_list_form" style="height:400px;" class="tab-pane"><form><fieldset> <div class="input-append">                        <select data-name="state" data-placeholder="State" style="width:140px;" class="data"><option value="">          </option><option value="uneditable">uneditable           </option><option value="disabled">disabled</option></select>&nbsp;                         <select data-name="groupState" data-placeholder="Group" style="width:140px;" class="data"><option value="">          </option><option value="warning">warning           </option><option value="success">success              </option><option value="error">error</option></select></div><div class="input-append"><select data-name="span" data-placeholder="Span" style="width:140px;" class="data"><option value="">          </option><option value="span1">span1           </option><option value="span2">span2           </option><option value="span3">span3           </option><option value="span4">span4           </option><option value="span5">span5           </option><option value="span6">span6           </option><option value="span7">span7           </option><option value="span8">span8           </option><option value="span9">span9           </option><option value="span10">span10           </option><option value="span11">span11           </option><option value="span12">span12           </option></select>&nbsp;                    <select data-name="size" data-placeholder="Size" style="width:140px;" class="data"><option value="">          </option><option value="input-xlarge">input-xlarge</option><option value="input-xxlarge">input-xxlarge</option><option value="input-large">input-large</option><option value="input-medium">input-medium</option><option value="input-small">input-small</option><option value="input-mini">input-mini</option></select></div><div class="input-append">                     <input type="text" data-name="name" placeholder="Name" style="width:300px" class="data"/></div><div class="input-append"><select data-name="helperType" data-placeholder="Helper" style="width:84px;" class="data"><option value=""></option><option value="inline">inline            </option><option value="block">block</option></select>&nbsp;<input type="text" data-name="helper" placeholder="Input Helper Text" style="width:202px" class="data"/></div><div class="input-append">                     <input type="text" data-name="placeholder" placeholder="Place Holder" style="width:300px" class="data"/></div><div class="input-append">                     <textarea rows="3" data-name="value" placeholder="Input Value" style="width:300px" class="data"></textarea></div></fieldset></form></div><div id="settings_list_base" style="height:400px;" class="tab-pane active"><form><fieldset><div class="input-append"><select data-name="depth" data-placeholder="Depth" style="width:84px;" class="span2 data"><option value="">         </option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5      </option></select>&nbsp;<select data-name="icon" data-placeholder="Icon" style="width:166px;" class="data"><option value="">       </option>'),function(){if("number"==typeof App.icon_list.length)for(var $index=0,$$l=App.icon_list.length;$index<$$l;$index++){var ic=App.icon_list[$index];buf.push("<option"),buf.push(attrs({value:ic},{value:!0})),buf.push(">");var __val__=ic;buf.push(null==__val__?"":__val__),buf.push("</option>")}else for(var $index in App.icon_list){var ic=App.icon_list[$index];buf.push("<option"),buf.push(attrs({value:ic},{value:!0})),buf.push(">");var __val__=ic;buf.push(null==__val__?"":__val__),buf.push("</option>")}}.call(this),buf.push('</select><span class="add-on ic-view-point"></span></div><div class="input-append"><select data-name="type" data-placeholder="Control Type" style="width:300px;" class="data"><option value=""></option><option value="text">text           </option><option value="select">select           </option><option value="checkbox">checkbox           </option><option value="radio">radio           </option><option value="textarea">textarea           </option><option value="file">file            </option></select></div><div class="input-append">                     <input type="text" data-name="title" placeholder="Insert Title" style="width:300px" class="data"/></div><div class="input-append">                     <input type="text" data-name="link" placeholder="Insert Link" style="width:300px" class="data"/></div><div class="input-append">                     <input type="text" data-name="image" placeholder="Insert Image" style="width:300px" class="data"/></div><div class="input-append">                     <textarea rows="3" data-name="content" placeholder="Input Content" style="width:300px" class="data"></textarea></div></fieldset></form></div></div><div class="data_target"></div></span></div>'))),isUpload&&buf.push('<div id="upload" class="tab-pane fade"><form name="upload" action="/uploads" method="post" enctype="multipart/form-data" target="image_upload"><fieldset style="padding-left:20px"><input type="file" name="image" class="file"/><button type="submit" class="btn btn-warning upload">Upload</button><iframe name="image_upload" height="50px" frameborder="0" class="span7"></iframe></fieldset></form></div>');if(isThemes){buf.push('<div id="themes" class="tab-pane fade"><ul style="width:700px;margin-left:20px;" class="thumbnails">');for(var i=1;i<=20;i++)buf.push('<li style="width:105px;" class="span2"><a'),buf.push(attrs({href:"#","data-themes":i,"class":"thumbnail themes-image"},{href:!0,"data-themes":!0})),buf.push("><img"),buf.push(attrs({src:"https://twitter.com/images/themes/theme"+i+"/swatch.gif"},{src:!0})),buf.push("/></a></li>");buf.push("</ul></div>")}buf.push('<div id="skin" class="tab-pane fade"><form class="form-horizontal"><fieldset style="padding-left: 20px;"><div class="control-group"><label class="control-label settings-label">Themes</label><div class="controls"> <select data-placeholder="Select Themes" class="themes"><option value=""></option>'),function(){if("number"==typeof themes.length)for(var $index=0,$$l=themes.length;$index<$$l;$index++){var obj=themes[$index];buf.push("<option"),buf.push(attrs({value:obj.link},{value:!0})),buf.push(">");var __val__=obj.name;buf.push(null==__val__?"":__val__),buf.push("</option>")}else for(var $index in themes){var obj=themes[$index];buf.push("<option"),buf.push(attrs({value:obj.link},{value:!0})),buf.push(">");var __val__=obj.name;buf.push(null==__val__?"":__val__),buf.push("</option>")}}.call(this),buf.push('</select></div></div><div class="control-group">           <div style="position:relative;height:300px;width:100%" class="skineditor_container"><div id="skineditor" style="position:absolute;top:0;bottom:0;left:0;right:0;">');var __val__=skin;buf.push(escape(null==__val__?"":__val__)),buf.push('</div></div></div></fieldset></form></div><div id="data" class="tab-pane fade in active"><form onSubmit="return false;" class="form-horizontal"><fieldset style="padding-left: 20px;">'),function(){if("number"==typeof infoList.length)for(var $index=0,$$l=infoList.length;$index<$$l;$index++){var obj=infoList[$index];buf.push('<div class="control-group">   ');if(obj.full)if(obj.type=="title")title_mixin(obj.value,obj.title);else if(obj.type=="select")select_mixin(obj.name,obj.select,obj.value,obj.title),buf.push("      ");else if(obj.type=="text")text_mixin(obj.value,obj.title,obj.rows);else if(obj.type=="editor"){buf.push("<div"),buf.push(attrs({style:"position:relative;height:"+obj.height+";width:"+obj.width,"class":"editor_container"},{style:!0})),buf.push('><div id="editor" style="position:absolute;top:0;bottom:0;left:0;right:0;">');var __val__=obj.value;buf.push(escape(null==__val__?"":__val__)),buf.push("</div></div>")}else if(obj.type=="input_text")input_text_mixin(obj.value,obj.name,obj.title),buf.push("     ");else if(obj.type=="html"){buf.push('<textarea id="html_contents" name="text" rows="20" style="width:95%" class="text">');var __val__=obj.value;buf.push(null==__val__?"":__val__),buf.push("</textarea>")}else if(obj.type=="jade"){buf.push('<textarea name="text" style="width:100%;height:260px;" class="text">');var __val__=obj.value;buf.push(null==__val__?"":__val__),buf.push("</textarea>")}else if(obj.type=="fulltext"){buf.push('<textarea name="text" style="width:100%;height:260px;" class="text">');var __val__=obj.value;buf.push(null==__val__?"":__val__),buf.push("</textarea>")}else obj.type=="tag"?tag_mixin(obj.value):obj.type=="li_text"?(li_text_mixin(obj.name,obj.value,obj.title),buf.push("               ")):obj.type=="li_checkbox"?li_checkbox_mixin(obj.name,obj.value,obj.title):obj.type=="checkbox"&&(checkbox_mixin(obj.name,obj.value,obj.title),buf.push("       "));else{buf.push('<label class="control-label settings-label">');var __val__=obj.title;buf.push(null==__val__?"":__val__),buf.push('</label><div class="controls">');if(obj.type=="title")title_mixin(obj.value,obj.title);else if(obj.type=="select")select_mixin(obj.name,obj.select,obj.value,obj.title),buf.push("      ");else if(obj.type=="text")text_mixin(obj.value,obj.title,obj.rows);else if(obj.type=="editor"){buf.push("<div"),buf.push(attrs({style:"position:relative;height:"+obj.height+";width:"+obj.width,"class":"editor_container"},{style:!0})),buf.push('><div id="editor" style="position:absolute;top:0;bottom:0;left:0;right:0;">');var __val__=obj.value;buf.push(escape(null==__val__?"":__val__)),buf.push("</div></div>")}else if(obj.type=="input_text")input_text_mixin(obj.value,obj.name,obj.title),buf.push("     ");else if(obj.type=="html"){buf.push('<textarea id="html_contents" name="text" rows="20" style="width:95%" class="text">');var __val__=obj.value;buf.push(null==__val__?"":__val__),buf.push("</textarea>")}else if(obj.type=="jade"){buf.push('<textarea name="text" style="width:100%;height:260px;" class="text">');var __val__=obj.value;buf.push(null==__val__?"":__val__),buf.push("</textarea>")}else if(obj.type=="fulltext"){buf.push('<textarea name="text" style="width:100%;height:260px;" class="text">');var __val__=obj.value;buf.push(null==__val__?"":__val__),buf.push("</textarea>")}else obj.type=="tag"?tag_mixin(obj.value):obj.type=="li_text"?(li_text_mixin(obj.name,obj.value,obj.title),buf.push("               ")):obj.type=="li_checkbox"?li_checkbox_mixin(obj.name,obj.value,obj.title):obj.type=="checkbox"&&(checkbox_mixin(obj.name,obj.value,obj.title),buf.push("       "));buf.push("</div>")}buf.push("</div>")}else for(var $index in infoList){var obj=infoList[$index];buf.push('<div class="control-group">   ');if(obj.full)if(obj.type=="title")title_mixin(obj.value,obj.title);else if(obj.type=="select")select_mixin(obj.name,obj.select,obj.value,obj.title),buf.push("      ");else if(obj.type=="text")text_mixin(obj.value,obj.title,obj.rows);else if(obj.type=="editor"){buf.push("<div"),buf.push(attrs({style:"position:relative;height:"+obj.height+";width:"+obj.width,"class":"editor_container"},{style:!0})),buf.push('><div id="editor" style="position:absolute;top:0;bottom:0;left:0;right:0;">');var __val__=obj.value;buf.push(escape(null==__val__?"":__val__)),buf.push("</div></div>")}else if(obj.type=="input_text")input_text_mixin(obj.value,obj.name,obj.title),buf.push("     ");else if(obj.type=="html"){buf.push('<textarea id="html_contents" name="text" rows="20" style="width:95%" class="text">');var __val__=obj.value;buf.push(null==__val__?"":__val__),buf.push("</textarea>")}else if(obj.type=="jade"){buf.push('<textarea name="text" style="width:100%;height:260px;" class="text">');var __val__=obj.value;buf.push(null==__val__?"":__val__),buf.push("</textarea>")}else if(obj.type=="fulltext"){buf.push('<textarea name="text" style="width:100%;height:260px;" class="text">');var __val__=obj.value;buf.push(null==__val__?"":__val__),buf.push("</textarea>")}else obj.type=="tag"?tag_mixin(obj.value):obj.type=="li_text"?(li_text_mixin(obj.name,obj.value,obj.title),buf.push("               ")):obj.type=="li_checkbox"?li_checkbox_mixin(obj.name,obj.value,obj.title):obj.type=="checkbox"&&(checkbox_mixin(obj.name,obj.value,obj.title),buf.push("       "));else{buf.push('<label class="control-label settings-label">');var __val__=obj.title;buf.push(null==__val__?"":__val__),buf.push('</label><div class="controls">');if(obj.type=="title")title_mixin(obj.value,obj.title);else if(obj.type=="select")select_mixin(obj.name,obj.select,obj.value,obj.title),buf.push("      ");else if(obj.type=="text")text_mixin(obj.value,obj.title,obj.rows);else if(obj.type=="editor"){buf.push("<div"),buf.push(attrs({style:"position:relative;height:"+obj.height+";width:"+obj.width,"class":"editor_container"},{style:!0})),buf.push('><div id="editor" style="position:absolute;top:0;bottom:0;left:0;right:0;">');var __val__=obj.value;buf.push(escape(null==__val__?"":__val__)),buf.push("</div></div>")}else if(obj.type=="input_text")input_text_mixin(obj.value,obj.name,obj.title),buf.push("     ");else if(obj.type=="html"){buf.push('<textarea id="html_contents" name="text" rows="20" style="width:95%" class="text">');var __val__=obj.value;buf.push(null==__val__?"":__val__),buf.push("</textarea>")}else if(obj.type=="jade"){buf.push('<textarea name="text" style="width:100%;height:260px;" class="text">');var __val__=obj.value;buf.push(null==__val__?"":__val__),buf.push("</textarea>")}else if(obj.type=="fulltext"){buf.push('<textarea name="text" style="width:100%;height:260px;" class="text">');var __val__=obj.value;buf.push(null==__val__?"":__val__),buf.push("</textarea>")}else obj.type=="tag"?tag_mixin(obj.value):obj.type=="li_text"?(li_text_mixin(obj.name,obj.value,obj.title),buf.push("               ")):obj.type=="li_checkbox"?li_checkbox_mixin(obj.name,obj.value,obj.title):obj.type=="checkbox"&&(checkbox_mixin(obj.name,obj.value,obj.title),buf.push("       "));buf.push("</div>")}buf.push("</div>")}}.call(this),buf.push('</fieldset></form></div></div></div><div class="modal-footer">'),isRoot||buf.push('<a class="btn btn-danger remove pull-left"><i class="icon-trash icon-white"></i>&nbsp;Delete</a>'),buf.push('<a title="Alt + s" class="btn btn-primary save"><i class="icon-share icon-white">  </i>&nbsp;<u>S</u>ave</a><a data-dismiss="modal" class="btn btn-inverse bClose"><i class="icon-stop icon-white">  </i>&nbsp;Close</a></div>')}return buf.join("")}}),define("logic/toy/ToySettings.js",["./tpl/settings.js"],function(tpl){return Backbone.View.extend({className:"modal hide",events:{"click a.remove":"remove","click a.save":"update","change .themes":"selectThemes","click a.themes-image":"selectThemes","swipeleft .tab-pane":"moveLeft","swiperight .tab-pane":"moveRight"},moveLeft:function(e){this.moveTab(1)},moveRight:function(e){this.moveTab(-1)},moveTab:function(step){var li=$(".modal-header-menu li.active"),obj=li;if(step>0)for(var i=0;i<step;i++){var temp=obj.next();temp&&(obj=temp)}else if(step<0)for(var i=step;i>0;i--){var temp=obj.prev();temp&&(obj=temp)}obj.find("a").tab("show")},setImageAttr:function(data){return data.imageType&&(data.cls="img-"+data.imageType),data.cls},selectThemes:function(e){var obj=$(e.currentTarget),index=obj.data("themes");this.resetThemes(index)},resetThemes:function(i){$("a.themes-image").removeClass("active"),$("a.themes-image[data-themes="+i+"]").addClass("active")},isRoot:function(){return this.parent.isRoot()},update:function(e){var data=_.extend({cid:this.parent.cid},this.getData(this.$el)),value=this.getPreview(data);$("html,body").animate({scrollTop:this.parent.$el.offset().top-100});var self=this;delete value.target,this.parent.setModel(value,function(){self.parent.update()}),this.$el.close()},getThemes:function(){return[{name:"SkinA",link:"/logic/themes/SkinA/index.css"},{name:"SkinB",link:"/logic/themes/SkinB/index.css"},{name:"SkinC",link:"/logic/themes/SkinC/index.css"},{name:"SkinD",link:"/logic/themes/SkinD/index.css"}]},preview:function(e){},remove:function(e){!this.isRoot()&&confirm("Delete this toy?")&&(this.$el.modal("hide"),this.parent.remove(),this.parent.$el.remove(),delete this.parent)},initialize:function(opt){opt.parent&&(this.parent=opt.parent)},getWindowWidth:function(){return{width:"940px",left:"40%"}},onShow:function(){},onClose:function(){},setEditor:function(id,mode,theme){id=id||"editor",mode=mode||"text",theme=theme||"twilight",this[id]=ace.edit(id),this[id].setTheme("ace/theme/"+theme),this[id].session.setMode("ace/mode/"+mode);var self=this;setTimeout(function(){self[id].focus(),self[id].commands.addCommand({name:"Save Contents",bindKey:{win:"Alt-S",mac:"Command-S"},exec:function(editor){self.update()}})},100)},setSkinEditor:function(){this.setEditor("skineditor","css")},open:function(){var self=this;this.render(),$("body").append(this.$el),this.$el.bPopup({onOpen:function(){var width=self.getWindowWidth();width&&self.$el.css(width),self.$("select").chosen({allow_single_deselect:!0}).trigger("liszt:updated").change(function(e){}),self.setSkinEditor(),self.onShow()},onClose:function(){self.onClose(),self.parent.setSelectedToy(),self.$el.remove()}})},getPreview:function(obj){return obj},getAttributeData:function(value,elem){return{}},getSkinText:function(data){var temp="";return(new less.Parser).parse(".skinText { "+data+" } ",function(e,root){temp=root.toCSS()}),temp},getDefaultAttributeData:function(value,elem){var cnt=elem.find(".tag").length,tag="";cnt>0&&(tag=_.map(elem.find(".tag").val().split(","),function(str){return $.trim(str)}));var skin=this.skineditor.getValue(),skinText=this.getSkinText(skin);return{title:elem.find(".title").val(),text:elem.find(".text").val(),span:elem.find(".spanarea option:selected").val(),hspan:elem.find(".hspanarea option:selected").val(),offset:elem.find(".offsetarea option:selected").val(),tag:tag,skin:skin,skinText:skinText,kind:elem.find(".kind option:selected").val()}},getLocalConfig:function(config){return _.extend(config,{kindList:this.kindList})},getData:function(elem){var value=this.parent.model.toJSON();return value=_.extend(value,this.getDefaultAttributeData(value,elem),this.getAttributeData(value,elem)),value},getTplConfig:function(){var defaultValue=this.parent.getDefaultValue(),data=this.parent.toJSON(),config=_.extend(defaultValue,data,{max_span:this.parent.getMaxSpan(),themes:this.getThemes(),isList:this.isList,isTable:this.isTable,isUpload:this.isUpload,isThemes:this.isThemes,isForm:this.isForm});return config.span_list=this.parent.getSpanList(config.max_span),this.getLocalConfig(config)},getTpl:function(data){return tpl(data)},onRender:function(data){},htmlEntities:function(str){return String(str).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},render:function(){var data=this.getTplConfig();return this.$el.html(this.getTpl(data)),this.$el.css("position","absolute"),this.$el.find(".modal-header").css("cursor","move"),this.delegateEvents(),this.onRender(data),this}})}),define("logic/toy/box/Settings.js",["../ToySettings.js"],function(ToySettings){return ToySettings.extend({isThemes:!0,rowTypeList:["default","fluid"],onShow:function(){var index=this.parent.model.get("themes");this.resetThemes(index)},getAttributeData:function(value,elem){var data={rowType:elem.find(".rowType option:selected").val()};return this.isRoot()&&(data.text=elem.find(".text").val()),data.themes=elem.find("a.themes-image.active").data("themes"),data},getLocalConfig:function(config){var infoList=[{type:"title",value:config.title},{type:"text",value:config.text},{type:"tag",value:config.tag}];return this.isRoot()&&infoList.unshift({type:"select",value:config.rowType,select:["default","fluid"],name:"rowType",title:"Row Type"}),_.extend(config,{infoList:infoList})}})}),define("logic/toy/box/Object.js",["../ToyContainer.js","./Settings.js"],function(ToyContainer,Settings){return ToyContainer.extend({className:"logic-comp logic-comp-box logic-container",type:"box",getDefaultValue:function(){return{rowType:"default",themes:0}},getSettings:function(){return new Settings({parent:this})},isRoot:function(){return this.model.get("isRoot")},setStyle:function(data){this.isRoot()?this.$el.addClass("rootBox"):(this.resetSpan(data.span),this.resetOffset(data.offset),App.mode=="write"&&this.$el.css("cursor","pointer"))},onRender:function(data){this.isRoot()&&(App.main.setTitle(data.title,data.tag),data.themes>0&&$("#userThemes").attr("href","/logic/themes/theme"+data.themes+"/"+data.themes+".css"))}})}),define("logic/LogicContents.js",["./toy/box/Object.js"],function(Box){return Backbone.View.extend({className:"logic-contents",initialize:function(opt){var value={isRoot:!0};opt._id&&(value._id=opt._id),this.rootBox=new Box(value),opt.mode&&this.setMode(opt.mode)},setMode:function(mode){this.rootBox.setMode(mode)},showMenu:function(isView){this.rootBox.showMenu(isView)},toData:function(){return this.rootBox.toData()},toJSON:function(){return this.rootBox.toJSON()},render:function(){return this.$el.append(this.rootBox.render().el),this.rootBox.show(),this}})}),define("logic/tpl/LogicSettings.js",["jadeRuntime"],function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;if(App.mode=="write"&&App.toy!=null){buf.push('<span> <a class="btn btn-info settings-btn"> <i'),buf.push(attrs({"class":"icon-white "+App.list[App.toy.type].icon},{"class":!0})),buf.push("></i>&nbsp; ");var __val__=App.list[App.toy.type].name;buf.push(null==__val__?"":__val__),buf.push("</a></span>")}}return buf.join("")}}),define("logic/LogicSettings.js",["./tpl/LogicSettings.js"],function(tpl){return Backbone.View.extend({className:"logic-settings btn-toolbar",events:{"click a.delete-btn":"deleteToy","click a.settings-btn":"settingsToy"},deleteToy:function(e){App.toy!=null&&App.toy.removeAll()},settingsToy:function(e){return App.toy!=null&&App.toy.selectEdit(e),!1},render:function(){return this.$el.html(tpl()),this}})}),define("logic/LogicMain.js",["./tpl/LogicMain.js","./LogicToolbar.js","./LogicMenuBox.js","./LogicContents.js","./LogicSettings.js"],function(tpl,LogicToolbar,LogicMenuBox,LogicContents,LogicSettings){return Backbone.View.extend({initialize:function(opt){this.mode=App.mode,this.toolbar=new LogicToolbar({_id:opt._id}),this.menubox=new LogicMenuBox,this.contents=new LogicContents({_id:opt._id}),this.settings=new LogicSettings,opt._id&&(this._id=opt._id)},setTitle:function(title,tags){tags=tags||[];var untitle="Untitled Document";if(App.mode=="view")var button=$('<a class="btn btn-success">Write</a>').on("click",function(e){location.href="/write/"+App.main.contents.rootBox.model.id});else var button=$('<a class="btn btn-success">View</a>').on("click",function(e){location.href="/view/"+App.main.contents.rootBox.model.id}),settings=$('<a class="btn btn-info" title="Settings"><i class="icon-cog icon-white"></a>').on("click",function(e){return App.main.contents.rootBox.selectEdit(),!1});var span=$("<span />");title?span.append(title).removeClass("untitled"):span.append(untitle).addClass("untitled"),App.mode=="write"?span.on("dblclick",function(e){var title=$(this).text(),text=$("<input type='text' />").val(title==untitle?"":title).addClass("span4");span.after(text).hide();var callback=function(e){var subtitle=$(this).val();subtitle==""?span.addClass("untitled"):span.removeClass("untitled"),span.text(subtitle==""?untitle:subtitle).show(),subtitle?span.removeClass("untitled"):span.addClass("untitled"),$(this).remove(),App.main.contents.rootBox.setModel({title:subtitle})};text.on("blur",callback).on("keydown",function(e){e.keyCode==13&&callback.call(this,e)}).focus()}):window.title=title+(title?" - ":"")+"EasyLogic";var h1=$("<h1 />").append(span);$(".boxeditor").html($("<div />").html(button)),App.mode=="write"&&$(".boxset").html($("<div />").html(settings)),this.$(".logic-view .titlebar").html(h1);if(tags.length>0){tags.sort();for(var i in tags){if(typeof tags[i]=="function")continue;var code=$("<code />").append(tags[i]);this.$(".logic-view .titlebar").append(code).append("&nbsp;")}}},setDocumentEvent:function(){$(document).click(function(e){App.initSelectToy(),$(".select_box").removeClass("select_box"),e.stopPropagation()}),$(document).keydown(function(e){if(App.mode=="view")return!1;if(!$(".bModal").length){App.toy!=null&&App.toy.$el.popover("destroy");if(e.keyCode==46)return App.toy!=null&&confirm("Delete a toy really?")&&(App.toy.remove(),App.toy.$el.remove(),delete App.toy,App.initSelectToy()),!1;if(e.keyCode==13)App.toy!=null&&App.toy.selectEdit();else if(e.shiftKey&&e.keyCode==187)$(".plus-btn").click();else if(e.ctrlKey&&e.shiftKey&&e.keyCode==39)App.toy!=null&&App.toy.moveNext();else if(e.ctrlKey&&e.keyCode==39)App.toy!=null&&App.toy.changeSpan(1);else if(e.shiftKey&&e.keyCode==39)App.toy!=null&&App.toy.changeOffset(1);else if(e.keyCode==39)if(App.toy!=null){var cid=App.toy.next().data("cid");cid||(cid=App.main.contents.rootBox.firstChild().data("cid")),App.toys[cid].setSelectedToy()}else{var cid=App.main.contents.rootBox.firstChild().data("cid");App.toys[cid].setSelectedToy()}else if(e.ctrlKey&&e.shiftKey&&e.keyCode==37)App.toy!=null&&App.toy.movePrev();else if(e.ctrlKey&&e.keyCode==37)App.toy!=null&&App.toy.changeSpan(-1);else if(e.shiftKey&&e.keyCode==37)App.toy!=null&&App.toy.changeOffset(-1);else if(e.keyCode==37)if(App.toy!=null){var cid=App.toy.prev().data("cid");cid||(cid=App.main.contents.rootBox.lastChild().data("cid")),App.toys[cid].setSelectedToy()}else{var cid=App.main.contents.rootBox.lastChild().data("cid");App.toys[cid].setSelectedToy()}}else if(e.altKey){var code=e.keyCode;if(49<=code&&code<=57){var index=code-49;$(".modal-header-menu li:eq("+index+") a").tab("show")}else code==83&&App.toy!=null&&App.toy.settings.update()}})},render:function(){return this.$el.html(tpl()),this.mode!="view"&&($("#toolbar").append(this.toolbar.render().el),$("#menubox").append(this.menubox.render().el),$("#settings").html(this.settings.render().el)),this.$(".logic-view .contents").append(this.contents.render().el),this.setDocumentEvent(),this}})}),define("logic/toy/alert/tpl/View.js",["jadeRuntime"],function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;buf.push("<div"),buf.push(attrs({"class":"alert alert-block "+("alert-"+kind)},{"class":!0})),buf.push(">");if(title){buf.push("<h4>");var __val__=title;buf.push(null==__val__?"":__val__),buf.push("</h4>")}if(text){var __val__=text;buf.push(null==__val__?"":__val__)}buf.push("<p>"),function(){if("number"==typeof list.length)for(var i=0,$$l=list.length;i<$$l;i++){var button=list[i];i>0&&!button.buttonBlock&&buf.push("&nbsp; "),buf.push("<a"),buf.push(attrs({href:button.link?button.link:"#","class":"btn "+button.cls},{"class":!0,href:!0})),buf.push(">"),button.buttonType?(buf.push("<i"),buf.push(attrs({"class":"icon-"+button.icon+" "+"icon-white"},{})),buf.push("></i>")):(buf.push("<i"),buf.push(attrs({"class":"icon-"+button.icon},{"class":!0})),buf.push("></i>")),buf.push("&nbsp;      ");var __val__=button.title;buf.push(null==__val__?"":__val__),buf.push("</a>")}else for(var i in list){var button=list[i];i>0&&!button.buttonBlock&&buf.push("&nbsp; "),buf.push("<a"),buf.push(attrs({href:button.link?button.link:"#","class":"btn "+button.cls},{"class":!0,href:!0})),buf.push(">"),button.buttonType?(buf.push("<i"),buf.push(attrs({"class":"icon-"+button.icon+" "+"icon-white"},{})),buf.push("></i>")):(buf.push("<i"),buf.push(attrs({"class":"icon-"+button.icon},{"class":!0})),buf.push("></i>")),buf.push("&nbsp;      ");var __val__=button.title;buf.push(null==__val__?"":__val__),buf.push("</a>")}}.call(this),buf.push("</p></div>")}return buf.join("")}}),define("logic/toy/ToyListSettings.js",["./ToySettings.js"],function(ToySettings){return ToySettings.extend({isList:!0,getList:function(){var list=[];return this.$(".data_list").find(".alert").each(function(i,obj){var obj=$(obj).data("obj");delete obj.target,list.push(obj)}),list},setButtonAttr:function(list){for(var i in list){var cls=[],button=list[i];button.buttonType&&cls.push("btn-"+button.buttonType),button.buttonSize&&cls.push("btn-"+button.buttonSize),button.buttonBlock&&cls.push("btn-"+button.buttonBlock),list[i].cls=cls.join(" ")}return list},getListTpl:function(obj){var content="<div>";return content+="<span ><i class='icon-"+obj.icon+"'></i>&nbsp;<span>"+obj.title+"</span></span>",content+="</div>",content},addLine:function(obj){return $("<div />").addClass("alert alert-success").data("obj",obj)},addList:function(obj){var self=this,content=this.getListTpl(obj),div=this.addLine(obj).html(content).css({"margin-left":obj.depth==""?"0px":parseInt(obj.depth)*10+"px","margin-bottom":"2px",cursor:"pointer"}).click(function(e){$(this).parent().find(".alert").removeClass("alert-danger"),$(this).addClass("alert-danger");var obj=$(this).data("obj");self.setDataList(obj),self.$(".data_target").data("target",this)});div.prepend("<button class='close'>&times;</button>"),div.find(".close").click(function(e){div.remove()}),this.$(".data_list").append(div)},modifyDataObject:function(obj){var $dom=$(obj.target);$dom.html(this.getListTpl($dom.data("obj"))),$dom.css({"margin-left":obj.depth==""?"0px":parseInt(obj.depth)*20+"px"})},modifyTab:function(obj){var $dom=$(obj.target);$dom.data("obj",obj),this.modifyDataObject(obj)},getDataList:function(){var list={};return this.$(".data[data-name]").each(function(i,obj){var $dom=$(obj);list[$dom.data("name")]=$dom.val()}),list},setDataList:function(obj){if(obj.empty){this.$(".data[data-name]").val("");return}for(var i in obj){if(typeof obj[i]=="function")continue;this.$(".data[data-name="+i+"]").val(obj[i]),this.$(".data[data-name="+i+"]").change().trigger("liszt:updated")}},onRender:function(data){var self=this;for(var i in data.list){var obj=data.list[i];if(typeof obj=="function")continue;this.addList(obj)}this.$("select[data-name=icon]").change(function(e){self.$(".ic-view-point").html("<i class='icon-"+$(this).val()+"'></i>")}),this.$(".add_data").click(function(){var obj=self.getDataList();self.addList(obj),self.setDataList({empty:!0})}),this.$(".modify_data").click(function(){var obj=self.getDataList();obj.target=self.$(".data_target").data("target"),self.modifyTab(obj)}),this.$(".data_list").sortable()}})}),define("logic/toy/alert/Settings.js",["./tpl/View.js","../ToyListSettings.js"],function(View,ToyListSettings){return ToyListSettings.extend({getAttributeData:function(value,elem){return{kind:elem.find(".kind option:selected").val(),list:this.getList()}},getPreview:function(obj){var data=obj;return data.title=this.htmlEntities(obj.title),data.text=markdown.toHTML(obj.text),data.list=this.setButtonAttr(data.list),obj.viewText=View(data),obj},getLocalConfig:function(config){return _.extend(config,{infoList:[{type:"select",value:config.kind,select:["default","info","success","error","info"],name:"kind",title:"Type "},{type:"title",value:config.title},{type:"text",value:config.text}]})}})}),define("logic/toy/alert/Object.js",["../ToyObject.js","./Settings.js"],function(Toy,Settings){return Toy.extend({className:"logic-comp logic-comp-alert",type:"alert",getSettings:function(){return new Settings({parent:this})},getDefaultValue:function(){return{kind:"default",list:[]}}})}),define("logic/toy/blockqoute/Settings.js",["../ToySettings.js"],function(ToySettings){return ToySettings.extend({getAttributeData:function(value,elem){return{kind:elem.find("select.kind option:selected").val()}},getPreview:function(obj){var temp=markdown.toHTML(obj.text);return obj.title&&(temp+="<small>"+this.htmlEntities(obj.title)+"</small>"),obj.viewText="<blockquote class='pull-"+obj.kind+"'>"+temp+"</blockquote>",obj},getLocalConfig:function(config){return _.extend(config,{infoList:[{type:"select",value:config.kind,select:["left","right"],name:"kind",title:"Type "},{type:"title",value:config.title},{type:"text",value:config.text,title:"Author"}]})}})}),define("logic/toy/blockqoute/Object.js",["../ToyObject.js","./Settings.js"],function(Toy,Settings){return Toy.extend({className:"logic-comp logic-comp-block",type:"blockqoute",getSettings:function(){return new Settings({parent:this})},getDefaultValue:function(){return{kind:"left"}},onRender:function(data){App.mode=="write"&&this.$("blockquote").css("float","none")}})}),define("logic/toy/breadcrumb/tpl/View.js",["jadeRuntime"],function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;if(title){buf.push("<h2>");var __val__=title;buf.push(null==__val__?"":__val__),buf.push("</h2>")}if(text){buf.push("<p>");var __val__=text;buf.push(null==__val__?"":__val__),buf.push("</p>")}buf.push('<ul class="breadcrumb">'),function(){if("number"==typeof list.length)for(var i=0,$$l=list.length;i<$$l;i++){var obj=list[i];buf.push("<li"),buf.push(attrs({"class":obj.activeType=="active"?"active":""},{"class":!0})),buf.push(">");if(obj.activeType=="active"){obj.icon&&(buf.push("<i"),buf.push(attrs({"class":"icon-"+obj.icon},{"class":!0})),buf.push("></i>&nbsp;			"));var __val__=obj.title;buf.push(null==__val__?"":__val__)}else{buf.push("<a"),buf.push(attrs({href:obj.link?obj.link:"#"},{href:!0})),buf.push(">"),obj.icon&&(buf.push("<i"),buf.push(attrs({"class":"icon-"+obj.icon},{"class":!0})),buf.push("></i>&nbsp;				"));var __val__=obj.title;buf.push(null==__val__?"":__val__),buf.push('</a><span class="divider">/</span>')}buf.push("</li>")}else for(var i in list){var obj=list[i];buf.push("<li"),buf.push(attrs({"class":obj.activeType=="active"?"active":""},{"class":!0})),buf.push(">");if(obj.activeType=="active"){obj.icon&&(buf.push("<i"),buf.push(attrs({"class":"icon-"+obj.icon},{"class":!0})),buf.push("></i>&nbsp;			"));var __val__=obj.title;buf.push(null==__val__?"":__val__)}else{buf.push("<a"),buf.push(attrs({href:obj.link?obj.link:"#"},{href:!0})),buf.push(">"),obj.icon&&(buf.push("<i"),buf.push(attrs({"class":"icon-"+obj.icon},{"class":!0})),buf.push("></i>&nbsp;				"));var __val__=obj.title;buf.push(null==__val__?"":__val__),buf.push('</a><span class="divider">/</span>')}buf.push("</li>")}}.call(this),buf.push("</ul>")}return buf.join("")}}),define("logic/toy/breadcrumb/Settings.js",["./tpl/View.js","../ToyListSettings.js"],function(View,ToyListSettings){return ToyListSettings.extend({getAttributeData:function(value,elem){return{list:this.getList()}},getPreview:function(obj){var data=obj;return data.title=this.htmlEntities(obj.title),obj.viewText=View(data),obj},getLocalConfig:function(config){return _.extend(config,{infoList:[{type:"title",value:config.title},{type:"text",value:config.text}]})}})}),define("logic/toy/breadcrumb/Object.js",["../ToyObject.js","./Settings.js"],function(ToyObject,Settings){return ToyObject.extend({className:"logic-comp logic-comp-breadcrumb",type:"breadcrumb",getSettings:function(){return new Settings({parent:this})},getDefaultValue:function(){return{list:[]}}})}),define("logic/toy/carousel/tpl/View.js",["jadeRuntime"],function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;if(title){buf.push("<h2>");var __val__=title;buf.push(null==__val__?"":__val__),buf.push("</h2>")}if(text){buf.push("<p>");var __val__=text;buf.push(null==__val__?"":__val__),buf.push("</p>")}buf.push("<div"),buf.push(attrs({id:"carousel_"+cid,"class":"carousel slide"},{id:!0})),buf.push('><div class="carousel-inner">'),function(){if("number"==typeof list.length)for(var i=0,$$l=list.length;i<$$l;i++){var obj=list[i];buf.push("<div"),buf.push(attrs({"class":"item "+(obj.activeType=="active"?"active":"")},{"class":!0})),buf.push("><img"),buf.push(attrs({src:obj.image},{src:!0})),buf.push("/>");if(obj.title||obj.text){buf.push('<div class="carousel-caption"><h4>');var __val__=obj.title;buf.push(null==__val__?"":__val__),buf.push("</h4><p>");var __val__=obj.text;buf.push(null==__val__?"":__val__),buf.push("</p></div>")}buf.push("</div>")}else for(var i in list){var obj=list[i];buf.push("<div"),buf.push(attrs({"class":"item "+(obj.activeType=="active"?"active":"")},{"class":!0})),buf.push("><img"),buf.push(attrs({src:obj.image},{src:!0})),buf.push("/>");if(obj.title||obj.text){buf.push('<div class="carousel-caption"><h4>');var __val__=obj.title;buf.push(null==__val__?"":__val__),buf.push("</h4><p>");var __val__=obj.text;buf.push(null==__val__?"":__val__),buf.push("</p></div>")}buf.push("</div>")}}.call(this),buf.push("</div>"),button&&(buf.push("<a"),buf.push(attrs({href:"#carousel_"+cid,"data-slide":"prev",style:"cursor:pointer","class":"carousel-control left"},{href:!0,"data-slide":!0,style:!0})),buf.push(">&lsaquo;</a><a"),buf.push(attrs({href:"#carousel_"+cid,"data-slide":"next",style:"cursor:pointer","class":"carousel-control right"},{href:!0,"data-slide":!0,style:!0})),buf.push(">&rsaquo;</a>")),buf.push("</div>")}return buf.join("")}}),define("logic/toy/carousel/Settings.js",["./tpl/View.js","../ToyListSettings.js"],function(View,ToyListSettings){return ToyListSettings.extend({getAttributeData:function(value,elem){return{list:this.getList(),delay:this.$(".delay").val(),button:this.$(".button").attr("checked")}},getPreview:function(obj){var data=obj;return data.title=this.htmlEntities(obj.title),data.text=markdown.toHTML(obj.text),obj.viewText=View(data),obj},getLocalConfig:function(config){return _.extend(config,{infoList:[{type:"li_text",value:config.delay,name:"delay",title:"Interval "},{type:"li_checkbox",value:config.button,name:"button",title:"Button "},{type:"title",value:config.title},{type:"text",value:config.text}]})}})}),define("logic/toy/carousel/Object.js",["../ToyObject.js","./Settings.js"],function(ToyObject,Settings){return ToyObject.extend({className:"logic-comp logic-comp-carousel",type:"carousel",getSettings:function(){return new Settings({parent:this})},getDefaultValue:function(){return{list:[],delay:5,button:!1}},onRender:function(data){this.$(".carousel").carousel({interval:data.delay*1e3})}})}),define("logic/toy/code/Settings.js",["../ToySettings.js"],function(ToySettings){return ToySettings.extend({syntaxList:["text","html","css","javascript","cpp","java","c_cpp","ruby","python","clj","css","go","hs","lisp","lua","ml","csharp","n","proto","scala","sql","tex","vb","vhdl","wiki","xq","yaml"],getAttributeData:function(value,elem){return{syntax:elem.find(".syntax option:selected").val()}},onShow:function(){this.setEditor("editor",this.parent.model.get("syntax")),this.$("select.syntax").change(function(e){self.editor.session.setMode("ace/mode/"+$(this).val())})},getPreview:function(obj){return obj.text=this.editor.getValue(),obj.viewText="<pre class='prettyprint linenums'>"+prettyPrintOne(this.htmlEntities(obj.text),obj.syntax,1)+"</pre>",obj},getLocalConfig:function(config){return _.extend(config,{infoList:[{type:"select",value:config.syntax,select:this.syntaxList,name:"syntax",title:"Syntax "},{type:"title",value:config.title,title:"Title"},{type:"editor",value:config.text,width:"100%",height:"300px",full:!0}]})}})}),define("logic/toy/code/Object.js",["../ToyObject.js","./Settings.js"],function(Toy,Settings){return Toy.extend({className:"logic-comp logic-comp-code",type:"code",getSettings:function(){return new Settings({parent:this})},getDefaultValue:function(){return{syntax:"text"}}})}),define("logic/toy/collapse/tpl/View.js",["jadeRuntime"],function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;if(title){buf.push("<h2>");var __val__=title;buf.push(null==__val__?"":__val__),buf.push("</h2>")}if(text){buf.push("<p>");var __val__=text;buf.push(null==__val__?"":__val__),buf.push("</p>")}buf.push("<div"),buf.push(attrs({id:"accordion_"+cid,"class":"accordion"},{id:!0})),buf.push(">"),function(){if("number"==typeof list.length)for(var i=0,$$l=list.length;i<$$l;i++){var obj=list[i];buf.push("<div"),buf.push(attrs({"class":"accordion-group "+("accordion_list_"+i)},{"class":!0})),buf.push('><div class="accordion-heading"><a'),buf.push(attrs({"data-toggle":"collapse","data-parent":" #accordion_"+cid,href:"#collapse_"+cid+"_"+i,"class":"accordion-toggle"},{"data-toggle":!0,"data-parent":!0,href:!0})),buf.push(">"),obj.icon&&(buf.push("<i"),buf.push(attrs({"class":"icon-"+obj.icon},{"class":!0})),buf.push("> </i>")),buf.push("&nbsp;");var __val__=obj.title;buf.push(null==__val__?"":__val__),buf.push("</a></div><div"),buf.push(attrs({id:"collapse_"+cid+"_"+i,"class":"accordion-body collapse "+(i==0?"in":"")},{"class":!0,id:!0})),buf.push('><div class="accordion-inner">');var __val__=obj.text;buf.push(null==__val__?"":__val__),buf.push("</div></div></div>")}else for(var i in list){var obj=list[i];buf.push("<div"),buf.push(attrs({"class":"accordion-group "+("accordion_list_"+i)},{"class":!0})),buf.push('><div class="accordion-heading"><a'),buf.push(attrs({"data-toggle":"collapse","data-parent":" #accordion_"+cid,href:"#collapse_"+cid+"_"+i,"class":"accordion-toggle"},{"data-toggle":!0,"data-parent":!0,href:!0})),buf.push(">"),obj.icon&&(buf.push("<i"),buf.push(attrs({"class":"icon-"+obj.icon},{"class":!0})),buf.push("> </i>")),buf.push("&nbsp;");var __val__=obj.title;buf.push(null==__val__?"":__val__),buf.push("</a></div><div"),buf.push(attrs({id:"collapse_"+cid+"_"+i,"class":"accordion-body collapse "+(i==0?"in":"")},{"class":!0,id:!0})),buf.push('><div class="accordion-inner">');var __val__=obj.text;buf.push(null==__val__?"":__val__),buf.push("</div></div></div>")}}.call(this),buf.push("</div>")}return buf.join("")}}),define("logic/toy/collapse/Settings.js",["./tpl/View.js","../ToyListSettings.js"],function(View,ToyListSettings){return ToyListSettings.extend({getAttributeData:function(value,elem){return{list:this.getList()}},getPreview:function(obj){var data=obj;return data.title=markdown.toHTML(data.title),data.text=markdown.toHTML(data.text),obj.viewText=View(data),obj},getLocalConfig:function(config){return _.extend(config,{infoList:[{type:"title",value:config.title},{type:"text",value:config.text}]})}})}),define("logic/toy/collapse/Object.js",["../ToyObject.js","./Settings.js"],function(ToyObject,Settings){return ToyObject.extend({className:"logic-comp logic-comp-accordion",type:"collapse",getSettings:function(){return new Settings({parent:this})},getDefaultValue:function(){return{list:[]}}})}),define("logic/toy/download/Settings.js",["../ToySettings.js"],function(ToySettings){return ToySettings.extend({isUpload:!0,getPreview:function(obj){return obj.viewText="<a href='"+this.htmlEntities(obj.text)+"' ><i class='icon-file'></i> "+this.htmlEntities(obj.title)+"</a>",obj},getLocalConfig:function(config){return _.extend(config,{infoList:[{type:"title",value:config.title},{type:"text",value:config.text}]})}})}),define("logic/toy/download/Object.js",["../ToyObject.js","./Settings.js"],function(Toy,Settings){return Toy.extend({className:"logic-comp logic-comp-download",type:"download",getSettings:function(){return new Settings({parent:this})}})}),define("logic/toy/form/tpl/View.js",["jadeRuntime"],function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;buf.push("<form"),buf.push(attrs({"class":kind?"form-"+kind:""},{"class":!0})),buf.push("><fieldset>");if(title){buf.push("<legend>");var __val__=title;buf.push(null==__val__?"":__val__),buf.push("</legend>")}(function(){if("number"==typeof list.length)for(var i=0,$$l=list.length;i<$$l;i++){var obj=list[i],el_id="element_"+cid+"_"+i;buf.push("<div"),buf.push(attrs({"class":"control-group "+(obj.groupState?obj.groupState:"")},{"class":!0})),buf.push("><label"),buf.push(attrs({"for":el_id,"class":"control-label"},{"for":!0})),buf.push(">");var __val__=obj.title;buf.push(null==__val__?"":__val__),buf.push('</label><div class="controls">');if(obj.type=="select"||obj.type=="multi-select")buf.push("<select"),buf.push(attrs({id:el_id,name:obj.name},{id:!0,name:!0})),buf.push('><option value=""></option>'),function(){if("number"==typeof obj.value.split(/\n/).length)for(var i=0,$$l=obj.value.split(/\n/).length;i<$$l;i++){var val=obj.value.split(/\n/)[i];buf.push("<option"),buf.push(attrs({value:i},{value:!0})),buf.push(">");var __val__=val;buf.push(null==__val__?"":__val__),buf.push("</option>")}else for(var i in obj.value.split(/\n/)){var val=obj.value.split(/\n/)[i];buf.push("<option"),buf.push(attrs({value:i},{value:!0})),buf.push(">");var __val__=val;buf.push(null==__val__?"":__val__),buf.push("</option>")}}.call(this),buf.push("</select>");else if(obj.type=="checkbox"||obj.type=="radio")(function(){if("number"==typeof obj.value.split(/\n/).length)for(var i=0,$$l=obj.value.split(/\n/).length;i<$$l;i++){var val=obj.value.split(/\n/)[i];buf.push("<label"),buf.push(attrs({"class":obj.type},{"class":!0})),buf.push("><input"),buf.push(attrs({type:obj.type,id:obj.name+"_"+i,name:obj.name+(obj.type=="checkbox"?"[]":""),value:val},{type:!0,id:!0,name:!0,value:!0})),buf.push("/>");var __val__=val;buf.push(null==__val__?"":__val__),buf.push("</label>")}else for(var i in obj.value.split(/\n/)){var val=obj.value.split(/\n/)[i];buf.push("<label"),buf.push(attrs({"class":obj.type},{"class":!0})),buf.push("><input"),buf.push(attrs({type:obj.type,id:obj.name+"_"+i,name:obj.name+(obj.type=="checkbox"?"[]":""),value:val},{type:!0,id:!0,name:!0,value:!0})),buf.push("/>");var __val__=val;buf.push(null==__val__?"":__val__),buf.push("</label>")}}).call(this);else{var state=obj.state=="disabled"?obj.state:"";state+=" "+(obj.state=="uneditable"?"uneditable-input":""),buf.push("<input"),buf.push(attrs({type:obj.type,id:el_id,name:obj.name,"class":state},{type:!0,id:!0,"class":!0,name:!0})),buf.push("/>")}if(obj.helper)if(obj.helperType=="inline"){buf.push('<span class="help-inline">');var __val__=obj.helper;buf.push(null==__val__?"":__val__),buf.push("</span>")}else{buf.push('<p class="help-block">');var __val__=obj.helper;buf.push(null==__val__?"":__val__),buf.push("</p>")}buf.push("</div></div>")}else for(var i in list){var obj=list[i],el_id="element_"+cid+"_"+i;buf.push("<div"),buf.push(attrs({"class":"control-group "+(obj.groupState?obj.groupState:"")},{"class":!0})),buf.push("><label"),buf.push(attrs({"for":el_id,"class":"control-label"},{"for":!0})),buf.push(">");var __val__=obj.title;buf.push(null==__val__?"":__val__),buf.push('</label><div class="controls">');if(obj.type=="select"||obj.type=="multi-select")buf.push("<select"),buf.push(attrs({id:el_id,name:obj.name},{id:!0,name:!0})),buf.push('><option value=""></option>'),function(){if("number"==typeof obj.value.split(/\n/).length)for(var i=0,$$l=obj.value.split(/\n/).length;i<$$l;i++){var val=obj.value.split(/\n/)[i];buf.push("<option"),buf.push(attrs({value:i},{value:!0})),buf.push(">");var __val__=val;buf.push(null==__val__?"":__val__),buf.push("</option>")}else for(var i in obj.value.split(/\n/)){var val=obj.value.split(/\n/)[i];buf.push("<option"),buf.push(attrs({value:i},{value:!0})),buf.push(">");var __val__=val;buf.push(null==__val__?"":__val__),buf.push("</option>")}}.call(this),buf.push("</select>");else if(obj.type=="checkbox"||obj.type=="radio")(function(){if("number"==typeof obj.value.split(/\n/).length)for(var i=0,$$l=obj.value.split(/\n/).length;i<$$l;i++){var val=obj.value.split(/\n/)[i];buf.push("<label"),buf.push(attrs({"class":obj.type},{"class":!0})),buf.push("><input"),buf.push(attrs({type:obj.type,id:obj.name+"_"+i,name:obj.name+(obj.type=="checkbox"?"[]":""),value:val},{type:!0,id:!0,name:!0,value:!0})),buf.push("/>");var __val__=val;buf.push(null==__val__?"":__val__),buf.push("</label>")}else for(var i in obj.value.split(/\n/)){var val=obj.value.split(/\n/)[i];buf.push("<label"),buf.push(attrs({"class":obj.type},{"class":!0})),buf.push("><input"),buf.push(attrs({type:obj.type,id:obj.name+"_"+i,name:obj.name+(obj.type=="checkbox"?"[]":""),value:val},{type:!0,id:!0,name:!0,value:!0})),buf.push("/>");var __val__=val;buf.push(null==__val__?"":__val__),buf.push("</label>")}}).call(this);else{var state=obj.state=="disabled"?obj.state:"";state+=" "+(obj.state=="uneditable"?"uneditable-input":""),buf.push("<input"),buf.push(attrs({type:obj.type,id:el_id,name:obj.name,"class":state},{type:!0,id:!0,"class":!0,name:!0})),buf.push("/>")}if(obj.helper)if(obj.helperType=="inline"){buf.push('<span class="help-inline">');var __val__=obj.helper;buf.push(null==__val__?"":__val__),buf.push("</span>")}else{buf.push('<p class="help-block">');var __val__=obj.helper;buf.push(null==__val__?"":__val__),buf.push("</p>")}buf.push("</div></div>")}}).call(this),buf.push("</fieldset></form>")}return buf.join("")}}),define("logic/toy/form/Settings.js",["./tpl/View.js","../ToyListSettings.js"],function(View,ToyListSettings){return ToyListSettings.extend({getAttributeData:function(value,elem){return{kind:elem.find(".kind option:selected").val(),list:this.getList()}},getPreview:function(obj){var data=obj;return data.title=this.htmlEntities(obj.title),data.text=markdown.toHTML(obj.text),obj.viewText=View(data),obj},getLocalConfig:function(config){return _.extend(config,{infoList:[{type:"select",value:config.kind,select:["default","search","inline","horizontal"],name:"kind",title:"Type "},{type:"title",value:config.title,title:"Title"},{type:"text",value:config.text,title:"Content"}]})}})}),define("logic/toy/form/Object.js",["../ToyObject.js","./Settings.js"],function(Toy,Settings){return Toy.extend({className:"logic-comp logic-comp-form",type:"form",isForm:!0,getSettings:function(){return new Settings({parent:this})},getDefaultValue:function(){return{kind:"default",list:[]}}})}),define("logic/toy/hero-unit/tpl/View.js",["jadeRuntime"],function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;buf.push('<div class="hero-unit">');if(title){buf.push("<h2>");var __val__=title;buf.push(null==__val__?"":__val__),buf.push("</h2>")}if(text){buf.push("<p>");var __val__=text;buf.push(null==__val__?"":__val__),buf.push("</p>")}buf.push("<p>"),function(){if("number"==typeof list.length)for(var $index=0,$$l=list.length;$index<$$l;$index++){var button=list[$index];buf.push("&nbsp;<a"),buf.push(attrs({href:button.link?button.link:"#","class":"btn btn-large "+button.cls},{"class":!0,href:!0})),buf.push(">"),button.buttonType?(buf.push("<i"),buf.push(attrs({"class":"icon-"+button.icon+" "+"icon-white"},{})),buf.push("></i>")):(buf.push("<i"),buf.push(attrs({"class":"icon-"+button.icon},{"class":!0})),buf.push("></i>")),buf.push("&nbsp;      ");var __val__=button.title;buf.push(null==__val__?"":__val__),buf.push("</a>")}else for(var $index in list){var button=list[$index];buf.push("&nbsp;<a"),buf.push(attrs({href:button.link?button.link:"#","class":"btn btn-large "+button.cls},{"class":!0,href:!0})),buf.push(">"),button.buttonType?(buf.push("<i"),buf.push(attrs({"class":"icon-"+button.icon+" "+"icon-white"},{})),buf.push("></i>")):(buf.push("<i"),buf.push(attrs({"class":"icon-"+button.icon},{"class":!0})),buf.push("></i>")),buf.push("&nbsp;      ");var __val__=button.title;buf.push(null==__val__?"":__val__),buf.push("</a>")}}.call(this),buf.push("</p></div>")}return buf.join("")}}),define("logic/toy/hero-unit/Settings.js",["./tpl/View.js","../ToyListSettings.js"],function(View,ToyListSettings){return ToyListSettings.extend({getAttributeData:function(value,elem){return{list:this.getList()}},getPreview:function(obj){var data=obj;return data.title=this.htmlEntities(obj.title),data.text=markdown.toHTML(obj.text),data.list=this.setButtonAttr(data.list),obj.viewText=View(data),obj},getLocalConfig:function(config){return _.extend(config,{infoList:[{type:"title",value:config.title},{type:"text",value:config.text}]})}})}),define("logic/toy/hero-unit/Object.js",["../ToyObject.js","./Settings.js"],function(ToyObject,Settings){return ToyObject.extend({className:"logic-comp logic-comp-hero-unit",type:"hero-unit",getSettings:function(){return new Settings({parent:this})},getDefaultValue:function(){return{list:[]}}})}),define("logic/toy/html/Settings.js",["../ToySettings.js"],function(ToySettings){return ToySettings.extend({getAttributeData:function(value,elem){var text=this.$("#html_contents").html();return{text:text}},onClose:function(){},onShow:function(){var self=this;setTimeout(function(){$("#html_contents").tinymce({script_url:"/lib/tiny_mce/tiny_mce.js",mode:"none",theme:"advanced",plugins:"autolink,lists,pagebreak,style,layer,table,save,advhr,advimage,advlink,emotions,iespell,inlinepopups,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras,template,advlist",theme_advanced_buttons1:"save,newdocument,|,bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,styleselect,formatselect,fontselect,fontsizeselect",theme_advanced_buttons2:"bullist,numlist,|,outdent,indent,blockquote,|,undo,redo,|,link,unlink,anchor,image,cleanup,help,|,insertdate,inserttime,preview,|,forecolor,backcolor,|,tablecontrols",theme_advanced_buttons3:"hr,removeformat,visualaid,|,sub,sup,|,media,advhr,|,print,|,fullscreen,code",theme_advanced_toolbar_location:"top",theme_advanced_toolbar_align:"left",theme_advanced_statusbar_location:"bottom",theme_advanced_resizing:!1,content_css:"/lib/bootstrap/css/bootstrap.css",template_replace_values:{},oninit:function(){self.$("#html_contents").tinymce().focus()},init_instance_callback:function(ed){ed.selection.getSel().collapseToEnd()},setup:function(ed){ed.onKeyDown.add(function(ed,evt){evt.altKey&&evt.keyCode==83?self.update(evt):evt.keyCode==27&&self.$el.close()})}})},10)},getPreview:function(obj){return obj.viewText=obj.text,obj},getLocalConfig:function(config){return _.extend(config,{infoList:[{type:"html",value:config.text,full:!0}]})}})}),define("logic/toy/html/Object.js",["../ToyObject.js","./Settings.js"],function(Toy,Settings){return Toy.extend({className:"logic-comp logic-comp-html",type:"html",getSettings:function(){return new Settings({parent:this})}})}),define("logic/toy/image/tpl/View.js",["jadeRuntime"],function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;link?(buf.push("<a"),buf.push(attrs({href:link},{href:!0})),buf.push("><img"),buf.push(attrs({src:image},{src:!0})),buf.push("/></a>")):(buf.push("<img"),buf.push(attrs({src:image,"class":cls},{src:!0,"class":!0})),buf.push("/>")),buf.push('<div class="caption">');if(title){buf.push("<h5>");var __val__=title;buf.push(null==__val__?"":__val__),buf.push("</h5>")}if(text){buf.push("<p>");var __val__=text;buf.push(null==__val__?"":__val__),buf.push("</p>")}list.length>0&&(buf.push("<p>"),function(){if("number"==typeof list.length)for(var $index=0,$$l=list.length;$index<$$l;$index++){var button=list[$index];buf.push("<a"),buf.push(attrs({href:button.link?button.link:"#","class":"btn "+button.cls},{"class":!0,href:!0})),buf.push(">");var __val__=button.title;buf.push(null==__val__?"":__val__),buf.push("&nbsp;</a>")}else for(var $index in list){var button=list[$index];buf.push("<a"),buf.push(attrs({href:button.link?button.link:"#","class":"btn "+button.cls},{"class":!0,href:!0})),buf.push(">");var __val__=button.title;buf.push(null==__val__?"":__val__),buf.push("&nbsp;</a>")}}.call(this),buf.push("</p>")),buf.push("</div>")}return buf.join("")}}),define("logic/toy/image/Settings.js",["./tpl/View.js","../ToyListSettings.js"],function(View,ToyListSettings){return ToyListSettings.extend({isUpload:!0,getAttributeData:function(value,elem){return{imageType:elem.find(".imageType").val(),image:elem.find(".image").val(),link:elem.find(".link").val(),list:this.getList()}},getPreview:function(obj){var data=obj;return data.title&&(data.title=this.htmlEntities(obj.title)),data.text&&(data.text=markdown.toHTML(obj.text)),data.cls=this.setImageAttr(data),data.list=this.setButtonAttr(data.list),obj.viewText=View(data),obj},getLocalConfig:function(config){return _.extend(config,{infoList:[{type:"select",value:config.imageType,select:["rounded","circle","polaroid"],name:"imageType",title:"Image Type "},{type:"input_text",value:config.image,name:"image",title:"Image "},{type:"input_text",value:config.link,name:"link",title:"Link "},{type:"title",value:config.title},{type:"text",value:config.text}]})}})}),define("logic/toy/image/Object.js",["../ToyObject.js","./Settings.js"],function(Toy,Settings){return Toy.extend({className:"logic-comp logic-comp-image",type:"image",getSettings:function(){return new Settings({parent:this})},getDefaultValue:function(){return{list:[],link:"",image:"",imageType:""}}})}),define("logic/toy/jade/Settings.js",["../ToySettings.js"],function(ToySettings){return ToySettings.extend({getPreview:function(obj){obj.text=this.editor.getValue();var jadeTpl=require("jade").get().compile(obj.text);return obj.viewText=jadeTpl(),obj},onShow:function(){this.setEditor("editor","textile")},getLocalConfig:function(config){return _.extend(config,{infoList:[{type:"editor",value:config.text,title:"",width:"100%",height:"300px",full:!0}]})}})}),define("logic/toy/jade/Object.js",["../ToyObject.js","./Settings.js"],function(Toy,Settings){return Toy.extend({className:"logic-comp logic-comp-jade",type:"jade",getSettings:function(){return new Settings({parent:this})}})}),define("logic/toy/label/Settings.js",["../ToySettings.js"],function(ToySettings){return ToySettings.extend({getPreview:function(obj){var text=$(markdown.toHTML(obj.text)),labelType="label label-";obj.labelType=="badge"&&(labelType="badge badge-"),text.prepend("<span class='"+labelType+""+this.htmlEntities(obj.kind)+"'>"+this.htmlEntities(obj.title)+"</span> ");var div=$("<div />");return div.append(text),obj.viewText=div.html(),obj},getAttributeData:function(value,elem){return{kind:elem.find(".kind option:selected").val(),labelType:elem.find(".labelType option:selected").val()}},getLocalConfig:function(config){return _.extend(config,{infoList:[{type:"select",value:config.labelType,select:["label","badge"],name:"labelType",title:"Label Type "},{type:"select",value:config.kind,select:["default","info","success","warning","important","inverse"],name:"kind",title:"Kind "},{type:"title",value:config.title,title:"Label"},{type:"text",value:config.text}]})}})}),define("logic/toy/label/Object.js",["../ToyObject.js","./Settings.js"],function(Toy,Settings){return Toy.extend({className:"logic-comp logic-comp-label",type:"label",getSettings:function(){return new Settings({parent:this})},getDefaultValue:function(){return{kind:"default",labelType:"label"}}})}),define("logic/toy/markdown/Settings.js",["../ToySettings.js"],function(ToySettings){return ToySettings.extend({getPreview:function(obj){return obj.text=this.editor.getValue(),obj.viewText=markdown.toHTML(obj.text),obj},onShow:function(){this.setEditor("editor","markdown")},getLocalConfig:function(config){return _.extend(config,{infoList:[{type:"editor",value:config.text,title:"",width:"100%",height:"300px",full:!0}]})}})}),define("logic/toy/markdown/Object.js",["../ToyObject.js","./Settings.js"],function(Toy,Settings){return Toy.extend({className:"logic-comp logic-comp-md",type:"markdown",getSettings:function(){return new Settings({parent:this})}})}),define("logic/toy/page-header/Settings.js",["../ToySettings.js"],function(ToySettings){return ToySettings.extend({getAttributeData:function(value,elem){return{kind:elem.find(".kind option:selected").val(),divider:elem.find(".divider option:selected").val()}},getPreview:function(obj){var $div=$("<div class='page-header' />"),header=$("<"+obj.kind+" />");return $div.append(header),header.append(this.htmlEntities(obj.title)),obj.divider=="divider"?header.after("<small>"+this.htmlEntities(obj.text)+"</small>"):header.append("<small>"+this.htmlEntities(obj.text)+"</small>"),obj.viewText=$("<div />").append($div).html(),obj},getLocalConfig:function(config){return _.extend(config,{infoList:[{type:"select",value:config.kind,select:["h1","h2","h3","h4"],name:"kind",title:"Size "},{type:"select",value:config.divider,select:["divider"],name:"divider",title:"Divider "},{type:"title",value:config.title,title:"Big Title"},{type:"text",value:config.text,title:"Small Title"}]})}})}),define("logic/toy/page-header/Object.js",["../ToyObject.js","./Settings.js"],function(Toy,Settings){return Toy.extend({className:"logic-comp logic-comp-page-header",type:"page-header",getSettings:function(){return new Settings({parent:this})},getDefaultValue:function(){return{kind:"h1",divider:""}}})}),define("logic/toy/pagination/tpl/View.js",["jadeRuntime"],function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;if(title){buf.push("<h2>");var __val__=title;buf.push(null==__val__?"":__val__),buf.push("</h2>")}if(text){buf.push("<p>");var __val__=text;buf.push(null==__val__?"":__val__),buf.push("</p>")}kind==""&&(className="pagination"),kind=="pager"&&(className="pager"),kind=="centered"&&(className="pagination pagination-centered"),buf.push("<div"),buf.push(attrs({"class":className},{"class":!0})),buf.push("><ul>"),function(){if("number"==typeof list.length)for(var $index=0,$$l=list.length;$index<$$l;$index++){var obj=list[$index];buf.push("<li"),buf.push(attrs({"class":obj.activeType},{"class":!0})),buf.push("><a"),buf.push(attrs({href:obj.link},{href:!0})),buf.push(">"),obj.icon&&(buf.push("<i"),buf.push(attrs({"class":"icon-"+obj.icon},{"class":!0})),buf.push("> </i>&nbsp;				"));var __val__=obj.title;buf.push(null==__val__?"":__val__),buf.push("</a></li>")}else for(var $index in list){var obj=list[$index];buf.push("<li"),buf.push(attrs({"class":obj.activeType},{"class":!0})),buf.push("><a"),buf.push(attrs({href:obj.link},{href:!0})),buf.push(">"),obj.icon&&(buf.push("<i"),buf.push(attrs({"class":"icon-"+obj.icon},{"class":!0})),buf.push("> </i>&nbsp;				"));var __val__=obj.title;buf.push(null==__val__?"":__val__),buf.push("</a></li>")}}.call(this),buf.push("</ul></div>")}return buf.join("")}}),define("logic/toy/pagination/Settings.js",["./tpl/View.js","../ToyListSettings.js"],function(View,ToyListSettings){return ToyListSettings.extend({getAttributeData:function(value,elem){return{list:this.getList(),kind:elem.find(".kind option:selected").val()}},getPreview:function(obj){var data=obj;return data.title=this.htmlEntities(obj.title),data.text=markdown.toHTML(obj.text),obj.viewText=View(data),obj},getLocalConfig:function(config){return _.extend(config,{infoList:[{type:"select",value:config.kind,select:["centered","pager"],name:"kind",title:"Type "},{type:"title",value:config.title},{type:"text",value:config.text}]})}})}),define("logic/toy/pagination/Object.js",["../ToyObject.js","./Settings.js"],function(ToyObject,Settings){return ToyObject.extend({className:"logic-comp logic-comp-pagination",type:"pagination",getSettings:function(){return new Settings({parent:this})},getDefaultValue:function(){return{list:[],kind:""}}})}),define("logic/toy/progress/Settings.js",["../ToySettings.js"],function(ToySettings){return ToySettings.extend({kindList:["default","info","success","warning","danger"],getAttributeData:function(value,elem){return{kind:elem.find(".kind option:selected").val(),percent:elem.find(".percent").val()}},getPreview:function(obj){var temp="<div class='progress progress-"+obj.kind+"'><div class='bar' style='width: "+parseInt(obj.percent)+"%'></div></div>";return obj.viewText=temp,obj},getLocalConfig:function(config){return _.extend(config,{infoList:[{type:"select",value:config.kind,select:["default","info","success","warning","danger"],name:"kind",title:"Type "},{type:"li_text",value:config.percent,name:"percent",title:"%"}]})}})}),define("logic/toy/progress/Object.js",["../ToyObject.js","./Settings.js"],function(Toy,Settings){return Toy.extend({className:"logic-comp logic-comp-progress",type:"progress",getSettings:function(){return new Settings({parent:this})},getDefaultValue:function(){return{kind:"default",percent:100}}})}),define("logic/toy/space/Settings.js",["../ToySettings.js"],function(ToySettings){return ToySettings.extend({getPreview:function(obj){return obj.viewText="&nbsp;",obj}})}),define("logic/toy/space/Object.js",["../ToyObject.js","./Settings.js"],function(Toy,Settings){return Toy.extend({className:"logic-comp logic-comp-space",type:"space",getSettings:function(){return new Settings({parent:this})}})}),define("logic/toy/stack/tpl/View.js",["jadeRuntime"],function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;buf.push("<ul"),buf.push(attrs({"class":"nav "+("nav-"+kind+"s nav-stacked")},{"class":!0})),buf.push(">"),function(){if("number"==typeof list.length)for(var i=0,$$l=list.length;i<$$l;i++){var obj=list[i];buf.push("<li"),buf.push(attrs({"data-index":i,"class":obj.activeType},{"class":!0,"data-index":!0})),buf.push("><a"),buf.push(attrs({"data-toggle":kind,"data-index":i,href:obj.link},{"data-toggle":!0,"data-index":!0,href:!0})),buf.push(">"),obj.icon&&(buf.push("<i"),buf.push(attrs({"class":"icon-"+obj.icon},{"class":!0})),buf.push("> </i>&nbsp;				"));var __val__=obj.title;buf.push(null==__val__?"":__val__),buf.push("</a></li>")}else for(var i in list){var obj=list[i];buf.push("<li"),buf.push(attrs({"data-index":i,"class":obj.activeType},{"class":!0,"data-index":!0})),buf.push("><a"),buf.push(attrs({"data-toggle":kind,"data-index":i,href:obj.link},{"data-toggle":!0,"data-index":!0,href:!0})),buf.push(">"),obj.icon&&(buf.push("<i"),buf.push(attrs({"class":"icon-"+obj.icon},{"class":!0})),buf.push("> </i>&nbsp;				"));var __val__=obj.title;buf.push(null==__val__?"":__val__),buf.push("</a></li>")}}.call(this),buf.push("</ul>")}return buf.join("")}}),define("logic/toy/stack/Settings.js",["./tpl/View.js","../ToyListSettings.js"],function(View,ToyListSettings){return ToyListSettings.extend({getAttributeData:function(value,elem){return{kind:elem.find(".kind option:selected").val(),list:this.getList()}},getPreview:function(obj){var data=obj;return data.title=this.htmlEntities(obj.title),data.text=markdown.toHTML(obj.text),obj.viewText=View(data),obj},getLocalConfig:function(config){return _.extend(config,{infoList:[{type:"select",value:config.kind,select:["tab","pill"],name:"kind",title:"Type "},{type:"title",value:config.title,title:"Title"},{type:"text",value:config.text,title:"Content"}]})}})}),define("logic/toy/stack/Object.js",["../ToyObject.js","./Settings.js"],function(ToyObject,Settings){return ToyObject.extend({className:"logic-comp logic-comp-stack",type:"stack",getSettings:function(){return new Settings({parent:this})},getDefaultValue:function(){return{list:[],kind:"tab",activeType:""}}})}),define("logic/toy/nav-list/tpl/View.js",["jadeRuntime"],function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;if(title){buf.push("<h2>");var __val__=title;buf.push(null==__val__?"":__val__),buf.push("</h2>")}if(text){buf.push("<p>");var __val__=text;buf.push(null==__val__?"":__val__),buf.push("</p>")}buf.push('<ul class="nav nav-list well">'),function(){if("number"==typeof list.length)for(var $index=0,$$l=list.length;$index<$$l;$index++){var obj=list[$index];if(obj.activeType=="divider")buf.push('<li class="divider"></li>');else{buf.push("<li"),buf.push(attrs({"class":obj.activeType},{"class":!0})),buf.push(">");if(obj.activeType=="nav-header"){var __val__=obj.title;buf.push(null==__val__?"":__val__)}else{buf.push("<a"),buf.push(attrs({href:obj.link},{href:!0})),buf.push("><i"),buf.push(attrs({"class":"icon-"+obj.icon},{"class":!0})),buf.push("> </i>&nbsp;				");var __val__=obj.title;buf.push(null==__val__?"":__val__),buf.push("</a>")}buf.push("</li>")}}else for(var $index in list){var obj=list[$index];if(obj.activeType=="divider")buf.push('<li class="divider"></li>');else{buf.push("<li"),buf.push(attrs({"class":obj.activeType},{"class":!0})),buf.push(">");if(obj.activeType=="nav-header"){var __val__=obj.title;buf.push(null==__val__?"":__val__)}else{buf.push("<a"),buf.push(attrs({href:obj.link},{href:!0})),buf.push("><i"),buf.push(attrs({"class":"icon-"+obj.icon},{"class":!0})),buf.push("> </i>&nbsp;				");var __val__=obj.title;buf.push(null==__val__?"":__val__),buf.push("</a>")}buf.push("</li>")}}}.call(this),buf.push("</ul>")}return buf.join("")}}),define("logic/toy/nav-list/Settings.js",["./tpl/View.js","../ToyListSettings.js"],function(View,ToyListSettings){return ToyListSettings.extend({getAttributeData:function(value,elem){return{list:this.getList()}},getPreview:function(obj){var data=obj;return data.title=this.htmlEntities(obj.title),data.text=markdown.toHTML(obj.text),obj.viewText=View(data),obj},getLocalConfig:function(config){return _.extend(config,{infoList:[{type:"title",value:config.title},{type:"text",value:config.text}]})}})}),define("logic/toy/nav-list/Object.js",["../ToyObject.js","./Settings.js"],function(ToyObject,Settings){return ToyObject.extend({className:"logic-comp logic-comp-nav-list",type:"nav-list",getSettings:function(){return new Settings({parent:this})},getDefaultValue:function(){return{list:[]}}})}),define("logic/toy/tab/tpl/View.js",["jadeRuntime"],function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;if(title){buf.push("<h2>");var __val__=title;buf.push(null==__val__?"":__val__),buf.push("</h2>")}if(text){buf.push("<p>");var __val__=text;buf.push(null==__val__?"":__val__),buf.push("</p>")}buf.push("<div"),buf.push(attrs({"class":"tabbable "+("tabs-"+directionType)},{"class":!0})),buf.push("><ul"),buf.push(attrs({id:"myTab_"+cid,"class":"nav "+("nav-"+kind+"s")},{"class":!0,id:!0})),buf.push(">"),function(){if("number"==typeof list.length)for(var i=0,$$l=list.length;i<$$l;i++){var obj=list[i];buf.push("<li"),buf.push(attrs({"class":obj.activeType=="active"?"active":""},{"class":!0})),buf.push("><a"),buf.push(attrs({"data-toggle":kind,href:"#tab-content-"+cid+"-"+i},{"data-toggle":!0,href:!0})),buf.push(">"),obj.icon&&(buf.push("<i"),buf.push(attrs({"class":"icon-"+obj.icon},{"class":!0})),buf.push("> </i>&nbsp;				"));var __val__=obj.title;buf.push(null==__val__?"":__val__),buf.push("</a></li>")}else for(var i in list){var obj=list[i];buf.push("<li"),buf.push(attrs({"class":obj.activeType=="active"?"active":""},{"class":!0})),buf.push("><a"),buf.push(attrs({"data-toggle":kind,href:"#tab-content-"+cid+"-"+i},{"data-toggle":!0,href:!0})),buf.push(">"),obj.icon&&(buf.push("<i"),buf.push(attrs({"class":"icon-"+obj.icon},{"class":!0})),buf.push("> </i>&nbsp;				"));var __val__=obj.title;buf.push(null==__val__?"":__val__),buf.push("</a></li>")}}.call(this),buf.push("</ul><div"),buf.push(attrs({id:"myTabContent_"+cid,"class":"tab-content"},{id:!0})),buf.push(">     "),function(){if("number"==typeof list.length)for(var i=0,$$l=list.length;i<$$l;i++){var obj=list[i];buf.push("<div"),buf.push(attrs({id:"tab-content-"+cid+"-"+i,"class":"tab-pane "+(obj.activeType=="active"?"active":"")},{"class":!0,id:!0})),buf.push(">");var __val__=obj.text;buf.push(null==__val__?"":__val__),buf.push("</div>")}else for(var i in list){var obj=list[i];buf.push("<div"),buf.push(attrs({id:"tab-content-"+cid+"-"+i,"class":"tab-pane "+(obj.activeType=="active"?"active":"")},{"class":!0,id:!0})),buf.push(">");var __val__=obj.text;buf.push(null==__val__?"":__val__),buf.push("</div>")}}.call(this),buf.push("</div></div>")}return buf.join("")}}),define("logic/toy/tab/Settings.js",["./tpl/View.js","../ToyListSettings.js"],function(View,ToyListSettings){return ToyListSettings.extend({getAttributeData:function(value,elem){return{list:this.getList(),tabType:this.$(".tabType").val(),directionType:this.$(".directionType").val()}},getPreview:function(obj){var data=obj;return data.title=this.htmlEntities(obj.title),data.text=markdown.toHTML(obj.text),obj.viewText=View(data),obj},getLocalConfig:function(config){return _.extend(config,{infoList:[{type:"select",value:config.kind,select:["tab","pill"],name:"kind",title:"Type "},{type:"select",value:config.direction,select:["below","left","right"],name:"directionType",title:"Direction "},{type:"title",value:config.title},{type:"text",value:config.text}]})}})}),define("logic/toy/tab/Object.js",["../ToyObject.js","./Settings.js"],function(ToyObject,Settings){return ToyObject.extend({className:"logic-comp logic-comp-tab",type:"tab",getSettings:function(){return new Settings({parent:this})},getDefaultValue:function(){return{list:[],tabType:"tab",directionType:"default"}}})}),define("logic/toy/table/Settings.js",["../ToySettings.js"],function(ToySettings){return ToySettings.extend({isList:!0,isTable:!0,getAttributeData:function(value,elem){return{list:this.getList(),writeMode:elem.find(".writeMode").val(),table:elem.find(".table").attr("checked"),striped:elem.find(".striped").attr("checked"),bordered:elem.find(".bordered").attr("checked"),condensed:elem.find(".condensed").attr("checked")}},getPreview:function(obj){var div=$("<div />"),table=$("<table />");div.html(table);for(var i in obj.list){var row=obj.list[i],rowEl=$("<tr />");for(var j in row){var col=row[j],colEl=$("<td />");if(obj.writeMode=="jade"){var jadeTpl=require("jade").get().compile(col);colEl.html(jadeTpl())}else obj.writeMode=="html"?colEl.html(col):colEl.html($(markdown.toHTML(col)).html());rowEl.append(colEl)}table.append(rowEl)}return obj.table&&table.addClass("table"),obj.striped&&table.addClass("table-striped"),obj.bordered&&table.addClass("table-bordered"),obj.condensed&&table.addClass("table-condensed"),obj.viewText=div.html(),obj},getLocalConfig:function(config){return _.extend(config,{writeModeList:this.writeModeList,infoList:[{type:"checkbox",value:config.table,name:"table",title:"Table "},{type:"checkbox",value:config.striped,name:"striped",title:"Striped "},{type:"checkbox",value:config.bordered,name:"bordered",title:"Bordered "},{type:"checkbox",value:config.condensed,name:"condensed",title:"Condensed "},{type:"select",value:config.writeMode,select:["markdown","html","jade"],name:"writeMode",title:"Write Mode"},{type:"title",value:config.title},{type:"text",value:config.text}]})},getList:function(){var rows=this.$(".list-row").length,list=this.$(".list-row td input[type=text].data").map(function(i,e){return e.value}).get(),cols=list.length/rows,data=[];for(var i in list){if(typeof list[i]=="function")continue;var r=parseInt(i/cols),c=i%cols,value=list[i];data[r]||(data[r]=[]),data[r][c]=value}return data},addRow:function(){var self=this,last=this.$(".list-row:last")[0];if(last){var obj=$(last).clone();obj.find("input[type=text]").val(""),obj.find(".move a.btn").click(function(e){obj.remove()}),this.$(".list").append(obj)}else this.initRow()},removeColumn:function(index){var idx=index;this.$(".list-row").each(function(i,obj){var selector="td:nth-child("+(idx+1)+") input[type=text]";$(obj).find(selector).parent().remove()}),this.$(".column td:nth-child("+(idx+1)+")").remove(),this.$(".column td a.btn:not(.ui-state-disabled)").each(function(i,e){var index=i+1;$(e).data("index",index),$(e).attr("data-index",index)})},addColumnButton:function(){var self=this,count=this.$(".column td").length||0,column=$("<td><a class='btn' style='width:70px;cursor: pointer;' data-index='"+count+"'>x</a></td>");column.find(".btn").click(function(e){var index=$(this).data("index");self.removeColumn(index)}),this.$(".column").append(column)},addColumn:function(){var self=this,last=this.$(".list-row:last")[0];last?(this.$(".list-row").each(function(i,e){$(e).append(self.getTextField())}),this.addColumnButton()):this.initRow()},initRow:function(){var obj=$('<tr class="list-row" />');obj.append(this.getMoveField()),obj.find(".move a.btn").click(function(e){obj.remove()}),obj.append(this.getTextField()),this.$(".list").append(obj),this.addColumnButton()},initRowData:function(){this.$(".list-row input[type=text]").val("")},getMoveField:function(){return"<td class='row move'><a class='btn' style='width:70px'>&times;</a></td>"},getTextField:function(value){return value=value||"","<td><input type='text' class='span1 data' style='margin:0px; margin-right: 2px; width: 80px;' value='"+value+"' /></td>"},loadData:function(list){list=list||[];if(list.length==0)return;var arr=list[0];for(var i=0;i<arr.length;i++)this.addColumn();for(var j=0;j<list.length-1;j++)this.addRow();var rows=this.$(".list-row");for(var index in list){if(typeof list[index]=="function")continue;$(rows[index]).find("input[type=text]").each(function(col,e){$(e).val(list[index][col])})}},setList:function(list){_.each(list,function(row,i){var rowEl=this.$(".list-row:nth-child("+(i+1)+")");rowEl.find("td input[type=text]").each(function(index,e){$(e).val(row[index])})})},changeData:function(arr,indexArr){var temp=[];return _.each(indexArr,function(i){temp.push(arr[i-1])}),temp},onRender:function(data){var self=this;this.$(".list").sortable().disableSelection(),this.$(".column").sortable({items:"td:not(.ui-state-disabled)",cancel:".ui-state-disabled",update:function(event,ui){var list=self.getList(),temp=self.$(".column td a.btn:not(.ui-state-disabled)").map(function(i,e){var index=$(e).data("index");return $(e).data("index",i+1),index}).get();_.each(list,function(obj,i){list[i]=self.changeData(list[i],temp)}),self.setList(list)}}).disableSelection(),this.$(".init_row").click(function(e){confirm("데이타를 비우겠습니까?")&&self.initRowData()}),this.$(".add_row").click(function(e){self.addRow()}),this.$(".add_column").click(function(e){self.addColumn()}),this.loadData(data.list)}})}),define("logic/toy/table/Object.js",["../ToyObject.js","./Settings.js"],function(Toy,Settings){return Toy.extend({className:"logic-comp logic-comp-table",type:"table",getSettings:function(){return new Settings({parent:this})},getDefaultValue:function(){return{kind:"default",list:[],table:!1,striped:!1,bordered:!1,condensed:!1,writeMode:"markdown"}}})}),define("logic/toy/text/tpl/View.js",["jadeRuntime"],function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;text||(text="&nbsp;&nbsp;&nbsp;&nbsp;");if(kind=="pre"){buf.push("<pre>");var __val__=text;buf.push(null==__val__?"":__val__),buf.push("</pre>")}else if(kind=="h1"){buf.push("<h1>");var __val__=text;buf.push(null==__val__?"":__val__),buf.push("</h1>")}else if(kind=="h2"){buf.push("<h2>");var __val__=text;buf.push(null==__val__?"":__val__),buf.push("</h2>")}else if(kind=="h3"){buf.push("<h3>");var __val__=text;buf.push(null==__val__?"":__val__),buf.push("</h3>")}else if(kind=="h4"){buf.push("<h4>");var __val__=text;buf.push(null==__val__?"":__val__),buf.push("</h4>")}else if(kind=="h5"){buf.push("<h5>");var __val__=text;buf.push(null==__val__?"":__val__),buf.push("</h5>")}else if(kind=="h6"){buf.push("<h6>");var __val__=text;buf.push(null==__val__?"":__val__),buf.push("</h6>")}else{buf.push("<p>");var __val__=text;buf.push(null==__val__?"":__val__),buf.push("</p>")}}return buf.join("")}}),define("logic/toy/text/Settings.js",["./tpl/View.js","../ToySettings.js"],function(View,ToySettings){return ToySettings.extend({htmlEntities:function(str){return String(str).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/\n/g,"<br />\n")},getPreview:function(obj){return obj.text=this.htmlEntities(this.editor.getValue()),obj.viewText=View(obj),obj},onShow:function(){this.setEditor("editor")},getLocalConfig:function(config){return _.extend(config,{infoList:[{type:"select",value:config.kind,select:["div","p","pre","h1","h2","h3","h4","h5","h6","a","section","header","footer"],name:"kind",title:"Type "},{type:"editor",value:config.text,title:"",width:"100%",height:"300px",full:!0}]})}})}),define("logic/toy/text/Object.js",["../ToyObject.js","./Settings.js"],function(Toy,Settings){return Toy.extend({className:"logic-comp logic-comp-text",type:"text",getSettings:function(){return new Settings({parent:this})},getDefaultValue:function(){return{kind:"p"}}})}),define("logic/toy/toolbar/tpl/View.js",["jadeRuntime"],function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;buf.push("<h2>");var __val__=title;buf.push(null==__val__?"":__val__),buf.push("</h2><p>");var __val__=text;buf.push(null==__val__?"":__val__),buf.push('</p><div class="btn-toolbar">');var start=1;(function(){if("number"==typeof toolbar.length)for(var i=0,$$l=toolbar.length;i<$$l;i++){var group=toolbar[i];buf.push("<div"),buf.push(attrs({"class":"btn-group "+(group[0]?"btn-group-"+group[0].groupType:"")},{"class":!0})),buf.push(">"),function(){if("number"==typeof group.length)for(var $index=0,$$l=group.length;$index<$$l;$index++){var button=group[$index];buf.push("<a"),buf.push(attrs({href:button.link?button.link:"#","class":"btn "+button.cls},{"class":!0,href:!0})),buf.push(">"),button.icon&&(button.buttonType?(buf.push("<i"),buf.push(attrs({"class":"icon-"+button.icon+" "+"icon-white"},{})),buf.push("></i>")):(buf.push("<i"),buf.push(attrs({"class":"icon-"+button.icon},{"class":!0})),buf.push("></i>")),buf.push("&nbsp;        "));var __val__=button.title;buf.push(null==__val__?"":__val__),buf.push("</a>")}else for(var $index in group){var button=group[$index];buf.push("<a"),buf.push(attrs({href:button.link?button.link:"#","class":"btn "+button.cls},{"class":!0,href:!0})),buf.push(">"),button.icon&&(button.buttonType?(buf.push("<i"),buf.push(attrs({"class":"icon-"+button.icon+" "+"icon-white"},{})),buf.push("></i>")):(buf.push("<i"),buf.push(attrs({"class":"icon-"+button.icon},{"class":!0})),buf.push("></i>")),buf.push("&nbsp;        "));var __val__=button.title;buf.push(null==__val__?"":__val__),buf.push("</a>")}}.call(this),buf.push("</div>")}else for(var i in toolbar){var group=toolbar[i];buf.push("<div"),buf.push(attrs({"class":"btn-group "+(group[0]?"btn-group-"+group[0].groupType:"")},{"class":!0})),buf.push(">"),function(){if("number"==typeof group.length)for(var $index=0,$$l=group.length;$index<$$l;$index++){var button=group[$index];buf.push("<a"),buf.push(attrs({href:button.link?button.link:"#","class":"btn "+button.cls},{"class":!0,href:!0})),buf.push(">"),button.icon&&(button.buttonType?(buf.push("<i"),buf.push(attrs({"class":"icon-"+button.icon+" "+"icon-white"},{})),buf.push("></i>")):(buf.push("<i"),buf.push(attrs({"class":"icon-"+button.icon},{"class":!0})),buf.push("></i>")),buf.push("&nbsp;        "));var __val__=button.title;buf.push(null==__val__?"":__val__),buf.push("</a>")}else for(var $index in group){var button=group[$index];buf.push("<a"),buf.push(attrs({href:button.link?button.link:"#","class":"btn "+button.cls},{"class":!0,href:!0})),buf.push(">"),button.icon&&(button.buttonType?(buf.push("<i"),buf.push(attrs({"class":"icon-"+button.icon+" "+"icon-white"},{})),buf.push("></i>")):(buf.push("<i"),buf.push(attrs({"class":"icon-"+button.icon},{"class":!0})),buf.push("></i>")),buf.push("&nbsp;        "));var __val__=button.title;buf.push(null==__val__?"":__val__),buf.push("</a>")}}.call(this),buf.push("</div>")}}).call(this),buf.push("</div>")}return buf.join("")}}),define("logic/toy/toolbar/Settings.js",["./tpl/View.js","../ToyListSettings.js"],function(View,ToyListSettings){return ToyListSettings.extend({getAttributeData:function(value,elem){return{list:this.getList()}},getPreview:function(obj){var data=obj;data.title=this.htmlEntities(obj.title),data.text=markdown.toHTML(obj.text),data.list=this.setButtonAttr(data.list);var toolbar=[],index=0;for(var i in data.list){if(typeof data.list[i]=="function")continue;toolbar[index]||(toolbar[index]=[]),toolbar[index].push(data.list[i]),data.list[i].last&&index++}return data.toolbar=toolbar,obj.viewText=View(data),obj},getLocalConfig:function(config){return _.extend(config,{infoList:[{type:"title",value:config.title},{type:"text",value:config.text}]})}})}),define("logic/toy/toolbar/Object.js",["../ToyObject.js","./Settings.js"],function(ToyObject,Settings){return ToyObject.extend({className:"logic-comp logic-comp-toolbar",type:"toolbar",getSettings:function(){return new Settings({parent:this})},getDefaultValue:function(){return{list:[]}}})}),define("logic/main",["./LogicMain.js","./toy/alert/Object.js","./toy/blockqoute/Object.js","./toy/box/Object.js","./toy/breadcrumb/Object.js","./toy/carousel/Object.js","./toy/code/Object.js","./toy/collapse/Object.js","./toy/download/Object.js","./toy/form/Object.js","./toy/hero-unit/Object.js","./toy/html/Object.js","./toy/image/Object.js","./toy/jade/Object.js","./toy/label/Object.js","./toy/markdown/Object.js","./toy/page-header/Object.js","./toy/pagination/Object.js","./toy/progress/Object.js","./toy/space/Object.js","./toy/stack/Object.js","./toy/nav-list/Object.js","./toy/tab/Object.js","./toy/table/Object.js","./toy/text/Object.js","./toy/toolbar/Object.js"],function(LogicMain){return{initialize:function(_id){window.console||(window.console={log:function(str){}}),window.App=_.extend(window.App,{main:{contents:{rootBox:{model:{id:"root",get:function(){return!1}}}}},GridWidth:60,GridGutter:20,MaxSpan:12,collection:{},toys:{},icon_list:["adjust","align-center","align-justify","align-left","align-right","arrow-down","arrow-left","arrow-right","arrow-up","asterisk","backward","ban-circle","barcode","bell","bold","book","bookmark","briefcase","bullhorn","calendar","camera","certificate","check","chevron-down","chevron-left","chevron-right","chevron-up","circle-arrow-down","circle-arrow-left","circle-arrow-right","circle-arrow-up","cog","comment","download","download-alt","edit","eject","envelope","exclamation-sign","eye-close","eye-open","facetime-video","fast-backward","fast-forward","file","film","filter","fire","flag","folder-close","folder-open","font","forward","fullscreen","gift","glass","globe","hand-down","hand-left","hand-right","hand-up","hdd","headphones","heart","home","inbox","indent-left","indent-right","info-sign","italic","leaf","list","list-alt","lock","magnet","map-marker","minus","minus-sign","move","music","off","ok","ok-circle","ok-sign","pause","pencil","picture","plane","play","play-circle","plus","plus-sign","print","qrcode","question-sign","random","refresh","remove","remove-circle","remove-sign","repeat","resize-full","resize-horizontal","resize-small","resize-vertical","retweet","road","screenshot","search","share","share-alt","shopping-cart","signal","star","star-empty","step-backward","step-forward","stop","tag","tags","tasks","text-height","text-width","th","th-large","th-list","thumbs-down","thumbs-up","time","tint","trash","upload","user","volume-down","volume-off","volume-up","warning-sign","wrench","zoom-in","zoom-out"],menubox:{basecss:{name:"Base CSS",view:"btn-success",list:["box","html","jade","markdown","text","code","form","nav-list","pagination","stack","table"]},component:{name:"Components",view:"btn-warning",list:["alert","breadcrumb","blockqoute","download","hero-unit","image","label","page-header","progress","space"]},plugin:{name:"Plugins",view:"btn-info",list:["carousel","collapse","tab","toolbar"]}},list:{box:{type:"box",name:"Box",icon:"icon-inbox",view:"btn-primary"},text:{type:"text",name:"Text",icon:"icon-text-width",view:"btn-danger"},html:{type:"html",name:"Html",icon:"icon-edit",view:"btn-danger"},jade:{type:"jade",name:"Jade",icon:"icon-refresh",view:"btn-danger"},markdown:{type:"markdown",name:"MarkDown",icon:"icon-list-alt",view:"btn-danger"},form:{type:"form",name:"Form",icon:"icon-briefcase",view:"btn-success"},code:{type:"code",name:"Code",icon:"icon-qrcode",view:"btn-success"},stack:{type:"stack",name:"Stack",icon:"icon-align-justify",view:"btn-success"},"nav-list":{type:"nav-list",name:"Nav Lists",icon:"icon-signal",view:"btn-success"},table:{type:"table",name:"Table",icon:"icon-th",view:"btn-success"},pagination:{type:"pagination",name:"Pagination",icon:"icon-leaf",view:"btn-success"},breadcrumb:{type:"breadcrumb",name:"Breadcrumbs",icon:"icon-forward",view:"btn-warning"},"hero-unit":{type:"hero-unit",name:"Hero Unit",icon:"icon-comment",view:"btn-warning"},alert:{type:"alert",name:"Alert",icon:"icon-info-sign",view:"btn-warning"},label:{type:"label",name:"Label",icon:"icon-tag",view:"btn-warning"},"page-header":{type:"page-header",name:"Page Header",icon:"icon-folder-open",view:"btn-warning"},blockqoute:{type:"blockqoute",name:"Blockqoute",icon:"icon-share",view:"btn-warning"},space:{type:"space",name:"Space",icon:"icon-resize-horizontal",view:"btn-warning"},image:{type:"image",name:"Image",icon:"icon-picture",view:"btn-warning"},download:{type:"download",name:"Download",icon:"icon-download",view:"btn-warning"},progress:{type:"progress",name:"Progress Bar",icon:"icon-minus",view:"btn-warning"},collapse:{type:"collapse",name:"Collapse",icon:"icon-tasks",view:"btn-info"},carousel:{type:"carousel",name:"Carousel",icon:"icon-play-circle",view:"btn-info"},tab:{type:"tab",name:"Tab",icon:"icon-th-list",view:"btn-info"},toolbar:{type:"toolbar",name:"Button Groups",icon:"icon-download-alt",view:"btn-info"}},toy:null,getId:function(){return App.main.contents.rootBox.model.id},getToy:function(id){return App.collection?App.collection[id]:!1},setToy:function(id,toy){App.collection||(App.collection[id]=toy)},showMenuBox:function(){App.main.menubox.show()},hideMenuBox:function(){App.main.menubox.hide()},setSelectToy:function(toy){App.toy=toy,App.main.settings.render()},initSelectToy:function(){App.toy!=null&&App.toy.$el.popover("destroy"),App.toy=null,App.main.settings.render()},initContextMenu:function(){App.toy!=null&&App.toy.initContextMenu()},require:function(type,callback){require(["logic/toy/"+type+"/Object.js"],function(obj){obj&&callback(obj)})}});var main=new LogicMain({_id:_id});App.main=main,$(".logic-main").html(main.render().el)}}})